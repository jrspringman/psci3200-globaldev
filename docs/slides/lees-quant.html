<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jeremy Springman">

<title>Quantitative Analysis – PSCI 3200</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../html/custom.scss">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">PSCI 3200</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../schedule.html"> 
<span class="menu-text">Schedule</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#statistical-review" id="toc-statistical-review" class="nav-link active" data-scroll-target="#statistical-review">Statistical Review</a>
  <ul class="collapse">
  <li><a href="#resources" id="toc-resources" class="nav-link" data-scroll-target="#resources">Resources</a></li>
  <li><a href="#quantitative-analysis-and-comparisons" id="toc-quantitative-analysis-and-comparisons" class="nav-link" data-scroll-target="#quantitative-analysis-and-comparisons">Quantitative Analysis and Comparisons</a></li>
  <li><a href="#correlations-necessary-components" id="toc-correlations-necessary-components" class="nav-link" data-scroll-target="#correlations-necessary-components">Correlations: Necessary Components</a></li>
  <li><a href="#central-tendency-mean" id="toc-central-tendency-mean" class="nav-link" data-scroll-target="#central-tendency-mean">Central Tendency: Mean</a></li>
  <li><a href="#spread-variance" id="toc-spread-variance" class="nav-link" data-scroll-target="#spread-variance">Spread: Variance</a></li>
  <li><a href="#spread-variance-1" id="toc-spread-variance-1" class="nav-link" data-scroll-target="#spread-variance-1">Spread: Variance</a></li>
  <li><a href="#spread-variance-2" id="toc-spread-variance-2" class="nav-link" data-scroll-target="#spread-variance-2">Spread: Variance</a></li>
  <li><a href="#spread-variance-3" id="toc-spread-variance-3" class="nav-link" data-scroll-target="#spread-variance-3">Spread: Variance</a></li>
  <li><a href="#spread-standard-deviation" id="toc-spread-standard-deviation" class="nav-link" data-scroll-target="#spread-standard-deviation">Spread: Standard Deviation</a></li>
  <li><a href="#spread-standard-deviation-1" id="toc-spread-standard-deviation-1" class="nav-link" data-scroll-target="#spread-standard-deviation-1">Spread: Standard Deviation</a></li>
  <li><a href="#measures-of-correlation" id="toc-measures-of-correlation" class="nav-link" data-scroll-target="#measures-of-correlation">Measures of Correlation</a></li>
  <li><a href="#measures-of-correlation-1" id="toc-measures-of-correlation-1" class="nav-link" data-scroll-target="#measures-of-correlation-1">Measures of Correlation</a></li>
  <li><a href="#measures-of-correlation-2" id="toc-measures-of-correlation-2" class="nav-link" data-scroll-target="#measures-of-correlation-2">Measures of Correlation</a></li>
  <li><a href="#measures-of-correlation-3" id="toc-measures-of-correlation-3" class="nav-link" data-scroll-target="#measures-of-correlation-3">Measures of Correlation</a></li>
  <li><a href="#measures-of-correlation-4" id="toc-measures-of-correlation-4" class="nav-link" data-scroll-target="#measures-of-correlation-4">Measures of Correlation</a></li>
  <li><a href="#measures-of-correlation-5" id="toc-measures-of-correlation-5" class="nav-link" data-scroll-target="#measures-of-correlation-5">Measures of Correlation</a></li>
  <li><a href="#correlation" id="toc-correlation" class="nav-link" data-scroll-target="#correlation">Correlation</a></li>
  <li><a href="#linear-regression-model" id="toc-linear-regression-model" class="nav-link" data-scroll-target="#linear-regression-model">Linear Regression Model</a></li>
  <li><a href="#linear-regression-model-1" id="toc-linear-regression-model-1" class="nav-link" data-scroll-target="#linear-regression-model-1">Linear Regression Model</a></li>
  <li><a href="#minimizing-the-residuals" id="toc-minimizing-the-residuals" class="nav-link" data-scroll-target="#minimizing-the-residuals">Minimizing the Residuals</a></li>
  <li><a href="#linear-regression-model-2" id="toc-linear-regression-model-2" class="nav-link" data-scroll-target="#linear-regression-model-2">Linear Regression Model</a></li>
  <li><a href="#multiple-regression" id="toc-multiple-regression" class="nav-link" data-scroll-target="#multiple-regression">Multiple Regression</a></li>
  <li><a href="#multiple-regression-1" id="toc-multiple-regression-1" class="nav-link" data-scroll-target="#multiple-regression-1">Multiple Regression</a></li>
  <li><a href="#multiple-regression-2" id="toc-multiple-regression-2" class="nav-link" data-scroll-target="#multiple-regression-2">Multiple Regression</a></li>
  <li><a href="#quiz-questions" id="toc-quiz-questions" class="nav-link" data-scroll-target="#quiz-questions">Quiz Questions</a></li>
  </ul></li>
  <li><a href="#causation" id="toc-causation" class="nav-link" data-scroll-target="#causation">Causation</a>
  <ul class="collapse">
  <li><a href="#schools-of-thought" id="toc-schools-of-thought" class="nav-link" data-scroll-target="#schools-of-thought">Schools of Thought</a></li>
  <li><a href="#causality-why-bother" id="toc-causality-why-bother" class="nav-link" data-scroll-target="#causality-why-bother">Causality: Why bother?</a></li>
  <li><a href="#causality-what-makes-it-hard" id="toc-causality-what-makes-it-hard" class="nav-link" data-scroll-target="#causality-what-makes-it-hard">Causality: What makes it hard?</a></li>
  <li><a href="#potential-outcomes-and-counterfactuals" id="toc-potential-outcomes-and-counterfactuals" class="nav-link" data-scroll-target="#potential-outcomes-and-counterfactuals">Potential Outcomes and Counterfactuals</a></li>
  <li><a href="#whats-the-solution" id="toc-whats-the-solution" class="nav-link" data-scroll-target="#whats-the-solution">What’s the solution?</a></li>
  <li><a href="#whats-complicated-about-this" id="toc-whats-complicated-about-this" class="nav-link" data-scroll-target="#whats-complicated-about-this">What’s complicated about this?</a></li>
  <li><a href="#cant-we-just-observe-and-compare" id="toc-cant-we-just-observe-and-compare" class="nav-link" data-scroll-target="#cant-we-just-observe-and-compare">Can’t we just observe and compare?</a></li>
  <li><a href="#cant-we-just-observe-and-compare-1" id="toc-cant-we-just-observe-and-compare-1" class="nav-link" data-scroll-target="#cant-we-just-observe-and-compare-1">Can’t we just observe and compare?</a></li>
  <li><a href="#cant-we-just-observe-and-compare-2" id="toc-cant-we-just-observe-and-compare-2" class="nav-link" data-scroll-target="#cant-we-just-observe-and-compare-2">Can’t we just observe and compare?</a></li>
  <li><a href="#cant-we-just-observe-and-compare-3" id="toc-cant-we-just-observe-and-compare-3" class="nav-link" data-scroll-target="#cant-we-just-observe-and-compare-3">Can’t we just observe and compare?</a></li>
  <li><a href="#cant-we-just-observe-and-compare-4" id="toc-cant-we-just-observe-and-compare-4" class="nav-link" data-scroll-target="#cant-we-just-observe-and-compare-4">Can’t we just observe and compare?</a></li>
  <li><a href="#cant-we-just-observe-and-compare-5" id="toc-cant-we-just-observe-and-compare-5" class="nav-link" data-scroll-target="#cant-we-just-observe-and-compare-5">Can’t we just observe and compare?</a></li>
  <li><a href="#cant-we-just-observe-and-compare-6" id="toc-cant-we-just-observe-and-compare-6" class="nav-link" data-scroll-target="#cant-we-just-observe-and-compare-6">Can’t we just observe and compare?</a></li>
  <li><a href="#cant-we-just-observe-and-compare-7" id="toc-cant-we-just-observe-and-compare-7" class="nav-link" data-scroll-target="#cant-we-just-observe-and-compare-7">Can’t we just observe and compare?</a></li>
  <li><a href="#cant-we-just-observe-and-compare-8" id="toc-cant-we-just-observe-and-compare-8" class="nav-link" data-scroll-target="#cant-we-just-observe-and-compare-8">Can’t we just observe and compare?</a></li>
  <li><a href="#cant-we-just-observe-and-compare-9" id="toc-cant-we-just-observe-and-compare-9" class="nav-link" data-scroll-target="#cant-we-just-observe-and-compare-9">Can’t we just observe and compare?</a></li>
  <li><a href="#why-cant-we-just-observe-how-units-change-over-time" id="toc-why-cant-we-just-observe-how-units-change-over-time" class="nav-link" data-scroll-target="#why-cant-we-just-observe-how-units-change-over-time">Why can’t we just observe how units change over time?</a></li>
  <li><a href="#why-cant-we-just-observe-how-units-change-over-time-1" id="toc-why-cant-we-just-observe-how-units-change-over-time-1" class="nav-link" data-scroll-target="#why-cant-we-just-observe-how-units-change-over-time-1">Why can’t we just observe how units change over time?</a></li>
  <li><a href="#why-cant-we-just-compare-units-without-randomization" id="toc-why-cant-we-just-compare-units-without-randomization" class="nav-link" data-scroll-target="#why-cant-we-just-compare-units-without-randomization">Why can’t we just compare units without randomization?</a></li>
  <li><a href="#why-cant-we-just-compare-units-without-randomization-1" id="toc-why-cant-we-just-compare-units-without-randomization-1" class="nav-link" data-scroll-target="#why-cant-we-just-compare-units-without-randomization-1">Why can’t we just compare units without randomization?</a></li>
  <li><a href="#causal-inference-tools" id="toc-causal-inference-tools" class="nav-link" data-scroll-target="#causal-inference-tools">Causal Inference Tools</a></li>
  </ul></li>
  <li><a href="#randomized-experimentss" id="toc-randomized-experimentss" class="nav-link" data-scroll-target="#randomized-experimentss">Randomized Experimentss</a>
  <ul class="collapse">
  <li><a href="#estimating-causal-effects-with-randomized-experiments" id="toc-estimating-causal-effects-with-randomized-experiments" class="nav-link" data-scroll-target="#estimating-causal-effects-with-randomized-experiments">Estimating Causal Effects with Randomized Experiments</a></li>
  <li><a href="#estimating-causal-effects-with-randomized-experiments-1" id="toc-estimating-causal-effects-with-randomized-experiments-1" class="nav-link" data-scroll-target="#estimating-causal-effects-with-randomized-experiments-1">Estimating Causal Effects with Randomized Experiments</a></li>
  <li><a href="#limitations-and-ethical-considerations" id="toc-limitations-and-ethical-considerations" class="nav-link" data-scroll-target="#limitations-and-ethical-considerations">Limitations and Ethical Considerations</a></li>
  <li><a href="#dealing-with-small-sample-sizes" id="toc-dealing-with-small-sample-sizes" class="nav-link" data-scroll-target="#dealing-with-small-sample-sizes">Dealing with Small Sample Sizes</a></li>
  <li><a href="#validity" id="toc-validity" class="nav-link" data-scroll-target="#validity">Validity</a></li>
  <li><a href="#additional-resources" id="toc-additional-resources" class="nav-link" data-scroll-target="#additional-resources">Additional Resources</a></li>
  </ul></li>
  <li><a href="#causal-inference-with-observational-data" id="toc-causal-inference-with-observational-data" class="nav-link" data-scroll-target="#causal-inference-with-observational-data">Causal Inference with Observational Data</a>
  <ul class="collapse">
  <li><a href="#causality-without-randomization" id="toc-causality-without-randomization" class="nav-link" data-scroll-target="#causality-without-randomization">Causality without Randomization</a></li>
  <li><a href="#identification-strategy" id="toc-identification-strategy" class="nav-link" data-scroll-target="#identification-strategy">Identification strategy</a></li>
  <li><a href="#holy-trinity-of-causal-inference" id="toc-holy-trinity-of-causal-inference" class="nav-link" data-scroll-target="#holy-trinity-of-causal-inference">Holy Trinity of Causal Inference</a></li>
  <li><a href="#identification-strategy-1" id="toc-identification-strategy-1" class="nav-link" data-scroll-target="#identification-strategy-1">Identification strategy</a></li>
  <li><a href="#difference-in-differences" id="toc-difference-in-differences" class="nav-link" data-scroll-target="#difference-in-differences">Difference-in-Differences</a></li>
  <li><a href="#simulation-example" id="toc-simulation-example" class="nav-link" data-scroll-target="#simulation-example">Simulation Example</a></li>
  <li><a href="#simulation-example-1" id="toc-simulation-example-1" class="nav-link" data-scroll-target="#simulation-example-1">Simulation Example</a></li>
  <li><a href="#did-assumptions" id="toc-did-assumptions" class="nav-link" data-scroll-target="#did-assumptions">DiD: Assumptions</a></li>
  <li><a href="#why-cant-we-just-observe-how-units-change-over-time-2" id="toc-why-cant-we-just-observe-how-units-change-over-time-2" class="nav-link" data-scroll-target="#why-cant-we-just-observe-how-units-change-over-time-2">Why can’t we just observe how units change over time?</a></li>
  <li><a href="#why-cant-we-just-observe-how-units-change-over-time-3" id="toc-why-cant-we-just-observe-how-units-change-over-time-3" class="nav-link" data-scroll-target="#why-cant-we-just-observe-how-units-change-over-time-3">Why can’t we just observe how units change over time?</a></li>
  <li><a href="#why-cant-we-just-compare-units-without-randomization-2" id="toc-why-cant-we-just-compare-units-without-randomization-2" class="nav-link" data-scroll-target="#why-cant-we-just-compare-units-without-randomization-2">Why can’t we just compare units without randomization?</a></li>
  <li><a href="#why-cant-we-just-compare-units-without-randomization-3" id="toc-why-cant-we-just-compare-units-without-randomization-3" class="nav-link" data-scroll-target="#why-cant-we-just-compare-units-without-randomization-3">Why can’t we just compare units without randomization?</a></li>
  <li><a href="#why-cant-we-just-compare-units-without-randomization-4" id="toc-why-cant-we-just-compare-units-without-randomization-4" class="nav-link" data-scroll-target="#why-cant-we-just-compare-units-without-randomization-4">Why can’t we just compare units without randomization?</a></li>
  <li><a href="#why-cant-we-just-compare-units-without-randomization-5" id="toc-why-cant-we-just-compare-units-without-randomization-5" class="nav-link" data-scroll-target="#why-cant-we-just-compare-units-without-randomization-5">Why can’t we just compare units without randomization?</a></li>
  <li><a href="#regression-discontinuity-designs" id="toc-regression-discontinuity-designs" class="nav-link" data-scroll-target="#regression-discontinuity-designs">Regression Discontinuity Designs</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1">Example</a></li>
  <li><a href="#example-2" id="toc-example-2" class="nav-link" data-scroll-target="#example-2">Example</a></li>
  <li><a href="#adjusting-on-observables" id="toc-adjusting-on-observables" class="nav-link" data-scroll-target="#adjusting-on-observables">Adjusting on Observables</a></li>
  </ul></li>
  <li><a href="#multiple-hypothesis-testing" id="toc-multiple-hypothesis-testing" class="nav-link" data-scroll-target="#multiple-hypothesis-testing">Multiple Hypothesis Testing</a>
  <ul class="collapse">
  <li><a href="#statistical-power" id="toc-statistical-power" class="nav-link" data-scroll-target="#statistical-power">Statistical Power</a></li>
  <li><a href="#statistical-power-1" id="toc-statistical-power-1" class="nav-link" data-scroll-target="#statistical-power-1">Statistical Power</a></li>
  <li><a href="#multiple-hypothesis-tests" id="toc-multiple-hypothesis-tests" class="nav-link" data-scroll-target="#multiple-hypothesis-tests">Multiple Hypothesis Tests</a></li>
  <li><a href="#creating-index-measures" id="toc-creating-index-measures" class="nav-link" data-scroll-target="#creating-index-measures">Creating Index Measures</a></li>
  <li><a href="#additive-scale" id="toc-additive-scale" class="nav-link" data-scroll-target="#additive-scale">Additive Scale</a></li>
  <li><a href="#additive-scale-1" id="toc-additive-scale-1" class="nav-link" data-scroll-target="#additive-scale-1">Additive Scale</a></li>
  <li><a href="#additive-scale-2" id="toc-additive-scale-2" class="nav-link" data-scroll-target="#additive-scale-2">Additive Scale</a></li>
  <li><a href="#averaged-z-scores" id="toc-averaged-z-scores" class="nav-link" data-scroll-target="#averaged-z-scores">Averaged Z-Scores</a></li>
  <li><a href="#averaged-z-scores-1" id="toc-averaged-z-scores-1" class="nav-link" data-scroll-target="#averaged-z-scores-1">Averaged Z-Scores</a></li>
  <li><a href="#averaged-z-scores-2" id="toc-averaged-z-scores-2" class="nav-link" data-scroll-target="#averaged-z-scores-2">Averaged Z-Scores</a></li>
  <li><a href="#averaged-z-scores-3" id="toc-averaged-z-scores-3" class="nav-link" data-scroll-target="#averaged-z-scores-3">Averaged Z-Scores</a></li>
  <li><a href="#fancier-index-techniques" id="toc-fancier-index-techniques" class="nav-link" data-scroll-target="#fancier-index-techniques">Fancier index techniques</a></li>
  </ul></li>
  <li><a href="#testing-heterogeneous-effects" id="toc-testing-heterogeneous-effects" class="nav-link" data-scroll-target="#testing-heterogeneous-effects">Testing Heterogeneous Effects</a>
  <ul class="collapse">
  <li><a href="#interaction-terms" id="toc-interaction-terms" class="nav-link" data-scroll-target="#interaction-terms">Interaction Terms</a></li>
  <li><a href="#interaction-terms-1" id="toc-interaction-terms-1" class="nav-link" data-scroll-target="#interaction-terms-1">Interaction Terms</a></li>
  <li><a href="#interaction-terms-2" id="toc-interaction-terms-2" class="nav-link" data-scroll-target="#interaction-terms-2">Interaction Terms</a></li>
  <li><a href="#survey-experiments" id="toc-survey-experiments" class="nav-link" data-scroll-target="#survey-experiments">Survey Experiments</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="lees-quant.pptx"><i class="bi bi-file-slides"></i>Powerpoint</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Quantitative Analysis</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Jeremy Springman </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            University of Pennsylvania
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  


</header>


<section id="statistical-review" class="level1">
<h1>Statistical Review</h1>
<section id="resources" class="level2">
<h2 class="anchored" data-anchor-id="resources">Resources</h2>
<p>This activity draws on Chapter 2 in <a href="https://press.princeton.edu/books/paperback/9780691199436/data-analysis-for-social-science">Data Analysis for Social Science: A Friendly and Practical Introduction (DSS)</a></p>
<ul>
<li><a href="https://ellaudet.iq.harvard.edu/mean_sd">interactive visualization: mean and sd</a></li>
<li><a href="https://ellaudet.iq.harvard.edu/correlation">interactive visualization: correlation</a></li>
</ul>
</section>
<section id="quantitative-analysis-and-comparisons" class="level2">
<h2 class="anchored" data-anchor-id="quantitative-analysis-and-comparisons">Quantitative Analysis and Comparisons</h2>
<ul>
<li>Comparisons are at the heart of quantitative analysis</li>
<li>Lots of bad analysis <em>implies</em> comparisons, but doesn’t actually make them
<ul>
<li>Ex. 10 things that extremely successful people do to be productive</li>
<li>Ex. 70% of participants reported an improvement</li>
</ul></li>
<li>Correlation is the most basic tool for making comparisons with data</li>
</ul>
<div class="notes">
<p>Making comparisons is one of the most essential parts in research, underpinning everything from simple descriptive studies to machine learning and impact evaluations. It is difficult to learn without comparison. For example, an article that identifies 10 habits of successful people might seek to provide guidance on what behaviors you can adopt to become more successful. However, we should also ask how common these behaviors are among people who are not successful. Similarly, an evaluation might point out that 70% of organizations that participated in a capacity-building intervention reported an improvement in their capacity over the course of the intervention. But we should also ask whether these improvements were larger than improvements experienced by similar organizations that didn’t participate. Correlation is the fundamental tool that allows us to answer these important questions.</p>
</div>
</section>
<section id="correlations-necessary-components" class="level2">
<h2 class="anchored" data-anchor-id="correlations-necessary-components">Correlations: Necessary Components</h2>
<p><strong>What do we need to calculate correlations?</strong></p>
<ul>
<li>Measures of central tendency
<ul>
<li>Mean</li>
<li>Proportion</li>
</ul></li>
<li>Measures of spread
<ul>
<li>Variance</li>
<li>Standard deviation</li>
</ul></li>
</ul>
<div class="notes">
<p>In order to calculate correlations, we need to begin with quantities that we want to compare across groups. For example, we might want to calculate the mean, or the average, of a certain variable. We also need to measure how much variation, or spread, there is in these measures. Are the units in our sample very similar, or are their values spread our across a wide range?</p>
</div>
</section>
<section id="central-tendency-mean" class="level2">
<h2 class="anchored" data-anchor-id="central-tendency-mean">Central Tendency: Mean</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>\mu_X = \frac{1}{n} \sum_{i}^{n} X_i</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>my_vector <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Sum the values</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>sum_values <span class="ot">&lt;-</span> <span class="fu">sum</span>(my_vector)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Count the number of elements</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>count_elements <span class="ot">&lt;-</span> <span class="fu">length</span>(my_vector)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Calculate the mean</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>mean_value <span class="ot">&lt;-</span> sum_values <span class="sc">/</span> count_elements</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mean_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.499699</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(my_vector)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.499699</code></pre>
</div>
</div>
<div class="notes">
<p>We begin by reviewing some basic statistical concepts and illustrating those concepts using R code. This will build your familiarity with R while providing a quick review of basic statistical concepts. Everyone knows how to calculate the mean of a variable. In R, there are multiple ways to do it. Here, I created a random variable with 10 values and an average value of 10. You can calculate the mean by hand or using the function ‘mean()’. Both approaches should give you the same value.</p>
</div>
</section>
<section id="spread-variance" class="level2">
<h2 class="anchored" data-anchor-id="spread-variance">Spread: Variance</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>\sigma^2_X = \frac{1}{N} \sum_{i}^{N} (X_i - \mu_X)^2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="incremental">
<ul class="incremental">
<li>What does the square in <code>\sigma^2</code> accomplish?</li>
<li>What are the implications for interpretation?
<ul class="incremental">
<li>Units</li>
<li>Distribution</li>
</ul></li>
<li>Even with these basic measures, we’re already thinking about the distribution!</li>
</ul>
</div>
<div class="notes">
<p>You’re also probably familiar with variance. Variance measures how spread out the values of a variable are around the mean. For the variance of X, we take the sum of the squared differences between each value of X and the mean value of X, and then divide by the number of observations. While squaring the differences is necessary to avoid positive and negative values cancelling out one another, it poses challenges for interpretation. Most importantly, the variance is not on the scale of the variable, so there is no intuitive way to interpret its value. The squaring of the differences also means that more weight is put on observations that are very far from the mean value. The next few slides illustrates this with simulated data.</p>
</div>
</section>
<section id="spread-variance-1" class="level2">
<h2 class="anchored" data-anchor-id="spread-variance-1">Spread: Variance</h2>
<div class="cell">
<details class="code-fold">
<summary>Create a vector</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Create vector, sort by size, and store var</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">=</span> <span class="fu">sort</span>(dat)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>o_var <span class="ot">=</span> <span class="fu">var</span>(dat)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  3.674694  6.565736  7.197622  7.771690  8.849113 10.352542 10.646439
 [8] 12.304581 17.793542 18.575325</code></pre>
</div>
</div>
<div class="notes">
<p>First, we create a vector of simulated data with a known mean and standard deviation. In statistics and computer science, a vector is a one-dimensional array, which is a data structure that stores elements of the same type in an ordered sequence.</p>
</div>
</section>
<section id="spread-variance-2" class="level2">
<h2 class="anchored" data-anchor-id="spread-variance-2">Spread: Variance</h2>
<div class="cell">
<details class="code-fold">
<summary>Add a constant to a big number</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Create new dataframe for big addition and store vector length</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>b_dat <span class="ot">=</span> dat</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">=</span> <span class="fu">length</span>(b_dat)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Add four to the largest number in the vector and calculate size of var increase</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>b_dat[ind] <span class="ot">=</span> b_dat[ind] <span class="sc">+</span> <span class="dv">4</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>b_var <span class="ot">=</span> <span class="fu">var</span>(b_dat)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>val <span class="ot">=</span> b_var <span class="sc">-</span> o_var</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Variance increases by"</span>, val )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Variance increases by 8.890842</code></pre>
</div>
</div>
<div class="notes">
<p>Second, we add 4 to the largest value of X and observe the change in the standard deviation</p>
</div>
</section>
<section id="spread-variance-3" class="level2">
<h2 class="anchored" data-anchor-id="spread-variance-3">Spread: Variance</h2>
<div class="cell">
<details class="code-fold">
<summary>Add a constant to a smaller number</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Create new dataframe for small addition</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>s_dat <span class="ot">=</span> dat</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Add four to the smallest number in the vector and calculate size of var increase</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>s_dat[ind<span class="dv">-2</span>] <span class="ot">=</span> s_dat[ind<span class="dv">-2</span>] <span class="sc">+</span> <span class="dv">4</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>s_var <span class="ot">=</span> <span class="fu">var</span>(s_dat)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>val <span class="ot">=</span> s_var <span class="sc">-</span> o_var</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Variance increases by"</span>, val )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Variance increases by 3.316847</code></pre>
</div>
</div>
<div class="notes">
<p>Finally, we add 4 to the smallest value of X and observe that the change in the standard deviation is much smaller. Again, this is because squaring the differences places more weight on extreme values very far from the mean</p>
</div>
</section>
<section id="spread-standard-deviation" class="level2">
<h2 class="anchored" data-anchor-id="spread-standard-deviation">Spread: Standard Deviation</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>\sigma_X = \sqrt{\frac{1}{N} \sum_{i}^{N} (X_i - \mu_X)^2}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="incremental">
<ul class="incremental">
<li>What does the <code>\sqrt{}</code> accomplish?</li>
<li>What are the implications for interpretation?
<ul class="incremental">
<li>Expressed in the same units as the observations</li>
<li>How far we expect each observation to be from the mean, on average</li>
</ul></li>
<li>It is often desirable to report effect sizes as SDs</li>
</ul>
</div>
<div class="notes">
<p>Another measure of spread is the standard deviation. The standard deviation is just the square-root of the variance, and tells us the average absolute difference between values of X and the mean of X. By taking the square root of the variance, we convert it back to the original units of the data, making it a more interpretable measure of dispersion. For example, if the data represents weights in kilograms, the standard deviation will also be in kilograms. A larger standard deviation indicates that the data points are more spread out from the mean, and a smaller standard deviation indicates that they are closer to the mean. In many research contexts, especially in the social sciences and medicine, it’s common to report effect sizes relative to the standard deviation. This is because it provides a scale of variability that can be used to compare the magnitude of an effect across different studies or different units of measurement. For example, an effect size of 0.2 standard deviations is often considered a small effect, regardless of the actual units of the data.</p>
</div>
</section>
<section id="spread-standard-deviation-1" class="level2">
<h2 class="anchored" data-anchor-id="spread-standard-deviation-1">Spread: Standard Deviation</h2>
<ul>
<li><a href="https://ellaudet.iq.harvard.edu/mean_sd">Check out this interactive visualization</a>
<ul>
<li>Observe how changes in the standard deviation affect the shape of the distribution</li>
</ul></li>
</ul>
<div class="notes">
<p>In a new tab, open this interactive visualization of how changes in the standard deviation affect the shape of the distribution. Follow the instructions to see what increases in the spead of a variable looks like.</p>
</div>
</section>
<section id="measures-of-correlation" class="level2">
<h2 class="anchored" data-anchor-id="measures-of-correlation">Measures of Correlation</h2>
<div class="incremental">
<ul class="incremental">
<li><span style="color:red;">Covariance</span> <code>\text{Cov}(X, Y) = \frac{1}{n} \sum_{i}^{N} (X_i - \bar{X})(Y_i - \bar{Y})</code>
<ul class="incremental">
<li>Product of the deviations</li>
<li>Range: unbounded</li>
</ul></li>
<li><span style="color:red;">Correlation coefficient</span> <code>\text{Cor}(X, Y) = \frac{\text{Cov}(X, Y)}{\sigma_X \sigma_Y}</code>
<ul class="incremental">
<li>Covariance normalized by product of SDs</li>
<li>Range: -1 to 1</li>
</ul></li>
</ul>
</div>
<div class="notes">
<p>Now that we have reviewed the fundamental components of correlation, we can turn to the three primary ways of measuring correlation. Correlations rely on two variables, typically denoted as X and Y.</p>
<p>Covariance measures the joint variability of two variables. As you can see from the equation, the covariance is calculated by summing the product of the deviations of X and Y and dividing this value by the number of observations. Deviations are calculated by taking each value of X and Y and subtracting the variable’s mean value. Covariance can tell us if increases in one variable generally correspond to increases in another (positive covariance), or if increases in one correspond to decreases in the other (negative covariance). However, the scale of the covariance is not standardized, making it difficult to interpret. , In fact, the results are unbounded, meaning that there is no minimum or maximum value for covariance.</p>
<p>Next, we turn to the correlation coefficient, which normalizes the covariance by the product of the variables’ standard deviations, forcing them to take a bounded range that can tell us the strength and direction of correlation. The Correlation Coefficient tells us the strength and direction of a linear relationship between two variables. A correlation of 1 means there is a perfect positive linear relationship, -1 means there is a perfect negative linear relationship, and 0 implies no linear relationship at all.</p>
<p>In summary, while covariance provides a first glance at the direction of a relationship, the correlation coefficient helps us understand both the strength and direction in a standardized format, making it easier to interpret and compare across different studies or datasets.</p>
</div>
</section>
<section id="measures-of-correlation-1" class="level2">
<h2 class="anchored" data-anchor-id="measures-of-correlation-1">Measures of Correlation</h2>
<div class="cell">
<details class="code-fold">
<summary>Calculate covariance</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate two vectors of 10 random numbers each from a normal distribution</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the means of both vectors</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>mean_x <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>mean_y <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the covariance between the two vectors</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>covariance <span class="ot">&lt;-</span> <span class="fu">sum</span>((x <span class="sc">-</span> mean_x) <span class="sc">*</span> (y <span class="sc">-</span> mean_y)) <span class="sc">/</span> (<span class="fu">length</span>(x) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(x,y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -4.657457</code></pre>
</div>
</div>
</section>
<section id="measures-of-correlation-2" class="level2">
<h2 class="anchored" data-anchor-id="measures-of-correlation-2">Measures of Correlation</h2>
<div class="cell">
<details class="code-fold">
<summary>Calculate correlation</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the standard deviations of both vectors</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>sd_x <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>sd_y <span class="ot">&lt;-</span> <span class="fu">sd</span>(y)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the correlation coefficient between the two vectors</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>correlation <span class="ot">&lt;-</span> covariance <span class="sc">/</span> (sd_x <span class="sc">*</span> sd_y)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x,y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.1752832</code></pre>
</div>
</div>
</section>
<section id="measures-of-correlation-3" class="level2">
<h2 class="anchored" data-anchor-id="measures-of-correlation-3">Measures of Correlation</h2>
<div class="incremental">
<ul class="incremental">
<li><span style="color:red;">Slope</span> <code>\beta_X = \frac{\text{Cov}(X, Y)}{\sigma^2_X}</code>
<ul class="incremental">
<li>Covariance normalized by variance</li>
<li>Expected change in <code>Y</code> with 1-unit change in <code>X</code></li>
</ul></li>
</ul>
</div>
<div class="notes">
<p>Finally, we can calculate the slope of a regression line, which normalized the covariance by the variance and tells us the expected change in Y when we observe a 1-unit increase in X. Here, “normalized” refers to the process of dividing the covariance of X and Y by the variance of X. Normalization refers to the process of scaling a variable so that it fits a specific scale. In this case, normalizing the covariance by the variance of X allows us to interpret the size of the slope in terms of the expect change in Y associated with a 1-unit increase in X.</p>
</div>
</section>
<section id="measures-of-correlation-4" class="level2">
<h2 class="anchored" data-anchor-id="measures-of-correlation-4">Measures of Correlation</h2>
<div class="cell">
<details class="code-fold">
<summary>Calculate slope</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the variance of X</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Variance = sum((X_i - mean_X)^2) / (n - 1)</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>variance_x <span class="ot">&lt;-</span> <span class="fu">sum</span>((x <span class="sc">-</span> mean_x)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (<span class="fu">length</span>(x) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the slope (beta) of Y on X</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Beta_X = Cov(X, Y) / Var(X)</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>beta_x <span class="ot">&lt;-</span> covariance <span class="sc">/</span> variance_x</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x)

Coefficients:
(Intercept)            x  
    10.9280      -0.1879  </code></pre>
</div>
</div>
</section>
<section id="measures-of-correlation-5" class="level2">
<h2 class="anchored" data-anchor-id="measures-of-correlation-5">Measures of Correlation</h2>
<div class="incremental">
<ul class="incremental">
<li>What does the correlation coefficient tell you that slope doesn’t?
<ul class="incremental">
<li>Consistency of the relationship on bounded scale (-1 to 1)</li>
</ul></li>
<li>What does slope tell you that the correlation coefficient doesn’t?
<ul class="incremental">
<li>Substantive importance (magnitude)</li>
</ul></li>
<li>Give an example of when you’d prefer each
<ul class="incremental">
<li>Correlation: When comparing relationships on different scales</li>
<li>Slope: When thinking about ROI</li>
</ul></li>
</ul>
</div>
<div class="notes">
<p>Here’s a quick review of the concepts we just covered.</p>
</div>
</section>
<section id="correlation" class="level2">
<h2 class="anchored" data-anchor-id="correlation">Correlation</h2>
<p><strong>What can with do with them?</strong></p>
<ul>
<li><span style="color:red;">Description</span>: quantitative comparisons</li>
<li><span style="color:red;">Forecasting</span>: sample population <code>\rightarrow</code> out-of-sample</li>
<li><span style="color:blue;">Causal inference</span>: correlation + research design</li>
</ul>
<p><strong>Simple, but powerful</strong></p>
<ul>
<li>Non-linearities, interactions, machine learning</li>
</ul>
<div class="notes">
<p>These simple but powerful statistical tools perform much of the work in contemporary quantitative social science research, ranging from simple description, to forecasting, to causal inference. These simple linear correlation can be combined with squared terms to estimate non-linear relationships, iterations to estimate how a relationship between two variables is affected by values of other variables, or powerful research designs to make inferences about causal relationships.</p>
</div>
</section>
<section id="linear-regression-model" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression-model">Linear Regression Model</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>Y_i = \alpha + \beta X_i + \epsilon_i</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="fragment">
<div class="incremental">
<ul class="incremental">
<li>What is <code>\alpha</code>?</li>
<li>What is <code>\beta</code>?</li>
<li>What is <code>X_i</code>?</li>
<li>What is <code>\epsilon_i</code>?</li>
</ul>
</div>
</div>
<div class="notes">
<p>Linear regression models are often referred to as the “workhorse of the social sciences”. Whether it’s estimating difference in political opinions across demographic groups or calculating the causal effect of a randomized intervention, most analyses rely on linear regression. The most frequently used model is called “Ordinary Least Squares”. The most simple models consisten of an intercept (alpha), which estimates the average value of Y when the independent variable is at 0, the slope or coefficient (beta) for X, which captures the relationship between X and Y (the independent and dependent variables), and the error term (epsion) which captures the variance in Y that is not explained by the intercept and beta.</p>
</div>
</section>
<section id="linear-regression-model-1" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression-model-1">Linear Regression Model</h2>
<p><strong>Estimating model parameters</strong></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>\hat{Y_i} = \hat{\alpha} + \hat{\beta} X_i</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Coefficient</strong></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>\hat{\beta} = \Delta{\hat{Y}} / \Delta{X}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="notes">
<p>Linear regression provides you with parameter estimates with which you can calculate the expected value of Y by adding together the terms on the right-hand-side of the equals sign in the model.</p>
</div>
</section>
<section id="minimizing-the-residuals" class="level2">
<h2 class="anchored" data-anchor-id="minimizing-the-residuals">Minimizing the Residuals</h2>
<p><strong>What are residuals</strong></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>\hat{\epsilon_i} = Y_i - \hat{Y_i}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>How do we minimize them?</strong></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>SSR = \sum_{i}^{N} \hat{\epsilon}_i^2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="notes">
<p>Ordinary least squares works by estimating parameter values the minimize the residuals of the model, which are the difference between each value of Y and the value predicted by the model based on the model parameters. As with our measures of variance, this is done using the sum of squared residuals, to avoid positive and negative differences from cancelling out.</p>
</div>
</section>
<section id="linear-regression-model-2" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression-model-2">Linear Regression Model</h2>
<ul>
<li><a href="https://ellaudet.iq.harvard.edu/least_squares">Check out this interactive visualization</a>
<ul>
<li>See how the least squares method is used to calculate the slope of the line by drawing a line that minimizes squared errors</li>
</ul></li>
<li><a href="https://ellaudet.iq.harvard.edu/linear_model">Check out this interactive visualization</a>
<ul>
<li>See how changes in the intercept and slope represents negative and positive relationships across different distributions of Y</li>
</ul></li>
</ul>
</section>
<section id="multiple-regression" class="level2">
<h2 class="anchored" data-anchor-id="multiple-regression">Multiple Regression</h2>
<div class="sourceCode" id="cb25"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>Y_i = \alpha + \beta_1 X_{i1} + \beta_2 X_{i2} + \epsilon_i</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="incremental">
<ul class="incremental">
<li>How does our interpretation of <code>\alpha</code> change?</li>
<li>How does our interpretation of <code>\beta_1</code> change?</li>
</ul>
</div>
<div class="notes">
<p>Multiple regression works very similarly to simple linear regression, although interpretation becomes slightly more complicated. The intercept (alpha) is not the mean of Y when both independent variables (X1 and X2) are held at 0, while the value of B1 now captures the relationship between X1 and Y while X2 is held constant.</p>
</div>
</section>
<section id="multiple-regression-1" class="level2">
<h2 class="anchored" data-anchor-id="multiple-regression-1">Multiple Regression</h2>
<div class="cell">
<details class="code-fold">
<summary>Multiple Regression</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'dplyr' was built under R version 4.1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<details class="code-fold">
<summary>Multiple Regression</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility of random numbers</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame with 100 observations</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">X1 =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">2</span>),    <span class="co"># Generate 100 random numbers for the first independent variable</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">X2 =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">2</span>),     <span class="co"># Generate 100 random numbers for the second independent variable</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">2</span>)      <span class="co"># Generate 100 random numbers for the dependent variable</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Introduce correlation between X1 and Y</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> data<span class="sc">$</span>X1 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="multiple-regression-2" class="level2">
<h2 class="anchored" data-anchor-id="multiple-regression-2">Multiple Regression</h2>
<div class="cell">
<details class="code-fold">
<summary>Multiple Regression</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lm() function fits linear models</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>simple_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1, <span class="at">data =</span> data)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Run multiple regression model (Y ~ X1 + X2)</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>multiple_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2, <span class="at">data =</span> data)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary() function provides a summary of the regression models</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Simple Linear Regression"</span> <span class="ot">=</span> simple_model,</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Multiple Regression"</span> <span class="ot">=</span> multiple_model</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate =</span> <span class="st">"{estimate}{stars} ({std.error})"</span>,</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">statistic =</span> <span class="cn">NULL</span>,</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">gof_omit =</span> <span class="st">'IC|RMSE|Log|F|R2$|Std.'</span>,</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">output =</span> <span class="st">"dataframe"</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       part        term         statistic Simple Linear Regression
1 estimates (Intercept) modelsummary_tmp1        10.219*** (0.594)
2 estimates          X1 modelsummary_tmp1         0.475*** (0.057)
3 estimates          X2 modelsummary_tmp1                         
4       gof    Num.Obs.                                        100
5       gof     R2 Adj.                                      0.405
  Multiple Regression
1   10.100*** (0.663)
2    0.476*** (0.058)
3       0.022 (0.055)
4                 100
5               0.400</code></pre>
</div>
</div>
</section>
<section id="quiz-questions" class="level2">
<h2 class="anchored" data-anchor-id="quiz-questions">Quiz Questions</h2>
<p><strong>Which of the following statements describe a correlation?</strong></p>
<ol type="1">
<li>Most professional data analysis took a statistics course in college.</li>
<li>The longer a person runs the more calories they burn.</li>
<li>People who live to be 100 years old typically take vitamins.</li>
<li>Older people vote more than younger people.</li>
</ol>
</section>
</section>
<section id="causation" class="level1">
<h1>Causation</h1>
<section id="schools-of-thought" class="level2">
<h2 class="anchored" data-anchor-id="schools-of-thought">Schools of Thought</h2>
<p>“We think of a cause as something that makes a difference, and the difference it makes must be a difference from what would have happened without it.” (Lewis, 1973)</p>
<ul>
<li>Potential outcomes and counterfactuals (Econ)</li>
<li>DAGs and do-calculus (CS)</li>
<li>Manipulability (Philosophy)</li>
</ul>
<div class="notes">
<p>While simple correlations can answer many important questions about the world, on their own, they cannot tell us anything about whether the relationship between X and Y is causal. We define causal relationships as a dependency whereby intervening on or manipulating the value of X while holding all other variables constant will result in a change in the value of Y. Causality is a central topic in philosophy of science, and there are many schools of thought around it. In social science research, most researchers focus on the Potential Outcomes framework.</p>
</div>
</section>
<section id="causality-why-bother" class="level2">
<h2 class="anchored" data-anchor-id="causality-why-bother">Causality: Why bother?</h2>
<ul>
<li>Understanding cause and effect is how we change things in the real world</li>
<li>Causal inference separates good evaluations from bad
<ul>
<li>Policy change</li>
<li>Development intervention</li>
</ul></li>
<li>Causal identification is not binary
<ul>
<li>It’s harder for some policies and interventions than others</li>
<li>Variety of tools that can help us rule out different threats to inference</li>
</ul></li>
</ul>
<div class="notes">
<p>As we’ll learn, it can be extremely difficult to estimate causal relationships in the social world. However, the ability to make positive change in the world requires an understanding cause and effect. However, most program evaluations cannot provide evidence of a causal impact and sometimes reliable causal inference is difficult or impossible.</p>
</div>
</section>
<section id="causality-what-makes-it-hard" class="level2">
<h2 class="anchored" data-anchor-id="causality-what-makes-it-hard">Causality: What makes it hard?</h2>
<p><strong>Fundamental Problem of Causal Inference</strong></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>Y_i = </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>\begin{cases} </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>Y_i(1) &amp; \text{if } D_i = 1 \text{ (treatment group)} \\</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>Y_i(0) &amp; \text{if } D_i = 0 \text{ (control group)}</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>\end{cases}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>We only observe any given unit in one treatment status at any one time so we can never directly observe the causal effect of a treatment on a unit.</li>
</ul>
<div class="notes">
<p>While estimating the correlation between two variables is straightforward, understanding whether this correlation captures a causal relationship is much more difficult. This is due to the “fundamental problem of causal inference”, which arises from our inability to observe counterfactuals. In causal inference, a counterfactual refers to the hypothetical outcome that would have occurred if a subject, who was exposed to a particular treatment or condition, had instead been exposed to a different treatment or no treatment at all. Counterfactuals are a fundamental concept in establishing causal relationships because they help to model what would have happened in an alternate scenario. We always think of causal relationships in terms of a counterfactual. Thinking about a causal relationship between a binary treatment variable D and an outcome Y, for any unit in our sample, we want to observe the value of Y in simultaneous worlds in which the unit does and does not receive the treatment D. For example, if we wanted to measure the effect of a malaria vaccine on the number of days a person misses work in a month, we want to observe simultaneous counterfactual worlds in which that person both does and does not receive the vaccine. Obviously, this is impossible. However, rigorous research designs allow us to estimate this relationship under certain conditions.</p>
</div>
</section>
<section id="potential-outcomes-and-counterfactuals" class="level2">
<h2 class="anchored" data-anchor-id="potential-outcomes-and-counterfactuals">Potential Outcomes and Counterfactuals</h2>
<p><strong>Treatment Effect for individual <code>i</code></strong></p>
<ul>
<li><code>TE_i = Y_i(1) - Y_i(0)</code></li>
</ul>
<p><strong>Average Treatment Effect (ATE)</strong></p>
<ul>
<li><code>ATE = \frac{1}{N} \sum_{i=1}^{N} TE_i</code></li>
</ul>
<div class="notes">
<p>Observing these simultaneous counterfactual worlds for each unit in our sample would allow us to easily estimate the average treatment effect for units in our sample. However, this is impossible.</p>
</div>
</section>
<section id="whats-the-solution" class="level2">
<h2 class="anchored" data-anchor-id="whats-the-solution">What’s the solution?</h2>
<p><strong>Estimating counterfactuals</strong></p>
<ul>
<li>Units in the control group serve as a stand-in for the counter-factual of the treatment group</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>\widehat{ATE} = \overline{Y}_{treatment\_group} - \overline{Y}_{control\_group}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="notes">
<p>While we can never directly observe a counterfactual, we can try to estimate it by using a credible research design. Causal inference methods attempt to do this by minimizing the probability of systematic differences between units that do and do not receive a treatment.</p>
</div>
</section>
<section id="whats-complicated-about-this" class="level2">
<h2 class="anchored" data-anchor-id="whats-complicated-about-this">What’s complicated about this?</h2>
<div class="incremental">
<ul class="incremental">
<li>“Only valid when when the treatment and control group are comparable with respect to <em>all the variables that might affect the outcome</em> other than the treatment variable itself.”</li>
<li>“We must <em>find or create a situation in which the treated observations and the untreated observations are similar</em> with respect to all the variables that might affect the outcome”</li>
<li>“By randomly assigning treatment, we ensure that treatment and control groups are, <em>on average</em>, identical to each other in all <em>observed and unobserved</em> pre-treatment characteristics”</li>
</ul>
</div>
<div class="notes">
<p>Units that have been exposed to the treatment can only serve as a valid counterfactual under very specific conditions. Under random assignment, the statistically most likely outcome is that treatment and control groups will not have any systematic differences that can confound our ability to estimate the treatment effect.</p>
</div>
</section>
<section id="cant-we-just-observe-and-compare" class="level2">
<h2 class="anchored" data-anchor-id="cant-we-just-observe-and-compare">Can’t we just observe and compare?</h2>
<p><img src="img/nyt-dag2.png" class="fragment img-fluid"></p>
<div class="notes">
<p>In the real world, differences in units’ exposure to X is often driven by important differences that also affect those units’ values of Y. This is called “confounding”. When confounding is present, our estimates of the causal effect of X on Y will be biased, potentially creating the illusion of a causal relationship that doesn’t actually exist. Consider this example, where the NYT reported on a study that found a correlation between opera attendance and longevity. Here, the journalists inferred that this correlation was causal, meaning that by changing whether or not someone goes to the opera, you can change how long they live. However, there are many factors that confound this relationship, including income, which is correlated with both opera attendance and lifespan.</p>
</div>
</section>
<section id="cant-we-just-observe-and-compare-1" class="level2">
<h2 class="anchored" data-anchor-id="cant-we-just-observe-and-compare-1">Can’t we just observe and compare?</h2>
<p><img src="img/largenstweet.png" class="img-fluid"></p>
<div class="notes">
<p>Many very smart people do not understand the fundamental problem of causal inference, leading them to underestimate the difficulty of estimating causal relationships without randomization. This can lead to fundamentally wrong conclusions about the impact that certain policies or interventions will have. For example, this Tweet captures an individual arguing that large sample sizes (erroneously referred to as “numbers of n’s”) allow you to interpret correlations as causal. However, this is extremely incorrect. Larger samples are subject to the exact same sources of confounding as small samples. Thinking back to the previous slide, there are still systematic differences between people that go to the opera and those who don’t. No matter how large the sample size, it would be wrong to assume that giving out opera tickets will prolong people’s lives. Understanding the challenges of causal inference and being able to communicate these challenges to others can be a huge advantage for researchers that want to help others learn about the world.</p>
</div>
</section>
<section id="cant-we-just-observe-and-compare-2" class="level2">
<h2 class="anchored" data-anchor-id="cant-we-just-observe-and-compare-2">Can’t we just observe and compare?</h2>
<p><strong>Example: What is the effect of class size on test scores</strong></p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ggdag'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lees-quant_files/figure-html/edu-ex-simple-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<p>Consider the challenge of estimating the effect of smaller class sizes on test scores. We want to know whether decreasing class sizes will cause an increase in the average test scores of students. We might start by looking at observational data on class size and test scores across a given district or country.</p>
</div>
</section>
<section id="cant-we-just-observe-and-compare-3" class="level2">
<h2 class="anchored" data-anchor-id="cant-we-just-observe-and-compare-3">Can’t we just observe and compare?</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lees-quant_files/figure-html/edu-ex-simplec-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<p>However, even if we find a negative correlation between larger class sizes and higher test scores, we cannot assume that this relationship is causal. If there are any unobserved factors that are correlated with both class size and score, this will confound our estimates.</p>
</div>
</section>
<section id="cant-we-just-observe-and-compare-4" class="level2">
<h2 class="anchored" data-anchor-id="cant-we-just-observe-and-compare-4">Can’t we just observe and compare?</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lees-quant_files/figure-html/edu-ex-simpleb-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<p>This would create the appearance of a causal relationship, even if one does not actually exist.</p>
</div>
</section>
<section id="cant-we-just-observe-and-compare-5" class="level2">
<h2 class="anchored" data-anchor-id="cant-we-just-observe-and-compare-5">Can’t we just observe and compare?</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lees-quant_files/figure-html/edu-ex-simpled-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<p>We might decide to collect data on additional characteristics of students and try to “control” for these potential confounders by including them in a multiple regression model. For example, it might be that wealthier students tend to be in schools with smaller class sizes. If you can control for parental wealth, we can remove this potential bias in your estimates.</p>
</div>
</section>
<section id="cant-we-just-observe-and-compare-6" class="level2">
<h2 class="anchored" data-anchor-id="cant-we-just-observe-and-compare-6">Can’t we just observe and compare?</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lees-quant_files/figure-html/edu-ex-full-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<p>However, adding the wrong control variables to your model can also create bias. When your dependent and independent variables have an effect on another variable in your model, this creates collider bias, which can cause the illusion of a causal relationship between X and Y by adding a control. For example, smaller class sizes might cause teachers to pay more attention to students. Higher test scores also might cause teachers to pay more attention to students. Controlling for the amount of attention students get from teachers would create the illusion of a relationship between class size and test scores even if one does not exist.</p>
</div>
</section>
<section id="cant-we-just-observe-and-compare-7" class="level2">
<h2 class="anchored" data-anchor-id="cant-we-just-observe-and-compare-7">Can’t we just observe and compare?</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lees-quant_files/figure-html/edu-ex-fullb-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<p>In reality, we can never control for all potential confounders, and we can never be certain that potential confounders we can control for are not colliders. If this figure captures every potential confounder, controlling for Year, Location, and Wealth would allow us to estimate the true causal effect of class sizes on test scores.</p>
</div>
</section>
<section id="cant-we-just-observe-and-compare-8" class="level2">
<h2 class="anchored" data-anchor-id="cant-we-just-observe-and-compare-8">Can’t we just observe and compare?</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lees-quant_files/figure-html/edu-ex-collider-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<p>However, in this figure, note the change in the direction of the arrow connecting Score and Attention. Now, Score has a causal effect on Attention. if we added a control for Attention, that would introduce collider bias.</p>
</div>
</section>
<section id="cant-we-just-observe-and-compare-9" class="level2">
<h2 class="anchored" data-anchor-id="cant-we-just-observe-and-compare-9">Can’t we just observe and compare?</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lees-quant_files/figure-html/edu-ex-fullc-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<p>And in this figure, no strategy will allow us to estimate a causal relationship because we don’t have data on U1 (hence it’s grey color).</p>
</div>
</section>
<section id="why-cant-we-just-observe-how-units-change-over-time" class="level2">
<h2 class="anchored" data-anchor-id="why-cant-we-just-observe-how-units-change-over-time">Why can’t we just observe how units change over time?</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>Year <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>Outcome <span class="ot">=</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fl">1.3</span>, <span class="fl">1.7</span>,<span class="cn">NA</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>Treatment <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Control"</span>, <span class="st">"Control"</span>,<span class="st">"Control"</span>,<span class="st">"Control"</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">=</span> <span class="fu">data.frame</span>(Year, Outcome, Treatment)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dat, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Outcome, <span class="at">group =</span> Treatment, <span class="at">color =</span> Treatment)) <span class="sc">+</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype=</span>Treatment),<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"solid"</span>)) <span class="sc">+</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1.85</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fl">1.85</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>) ) <span class="sc">+</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lees-quant_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<p>A natural response is to wonder about whether we can allow units to serve as their own control group over time. Imagine that we collect data on units in Year 1 before a treatment is administered and again in Year 2 after a treatment is administered.</p>
</div>
</section>
<section id="why-cant-we-just-observe-how-units-change-over-time-1" class="level2">
<h2 class="anchored" data-anchor-id="why-cant-we-just-observe-how-units-change-over-time-1">Why can’t we just observe how units change over time?</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>Year <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>Outcome <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">1.3</span>, <span class="fl">1.7</span>, <span class="fl">2.1</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>Treatment <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Control"</span>, <span class="st">"Control"</span>,<span class="st">"Control"</span>,<span class="st">"Control"</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">=</span> <span class="fu">data.frame</span>(Year, Outcome, Treatment)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dat, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Outcome, <span class="at">group =</span> Treatment, <span class="at">color =</span> Treatment)) <span class="sc">+</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype=</span>Treatment),<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fl">1.85</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"solid"</span>, <span class="st">"solid"</span>)) <span class="sc">+</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>) ) <span class="sc">+</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.85</span>), <span class="at">clip =</span> <span class="st">"on"</span>) <span class="sc">+</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lees-quant_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<p>Here, we cannot know how the units in our sample would have changed in the absence of the intervention. In this figure, we see that the units were increasing at the same rate in the two years before they received the intervention, and likely would have increased the same amount without the intervention.</p>
</div>
</section>
<section id="why-cant-we-just-compare-units-without-randomization" class="level2">
<h2 class="anchored" data-anchor-id="why-cant-we-just-compare-units-without-randomization">Why can’t we just compare units without randomization?</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>Year <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>Outcome <span class="ot">=</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fl">1.2</span>, <span class="fl">1.4</span>, <span class="cn">NA</span>, </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>            <span class="cn">NA</span>, <span class="fl">1.3</span>, <span class="fl">1.7</span>, <span class="cn">NA</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>Treatment <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Non-treated"</span>, <span class="st">"Non-treated"</span>,<span class="st">"Non-treated"</span>,<span class="st">"Non-treated"</span>, </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Treatment"</span>, <span class="st">"Treatment"</span>, <span class="st">"Treatment"</span>, <span class="st">"Treatment"</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">=</span> <span class="fu">data.frame</span>(Year, Outcome, Treatment)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dat, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Outcome, <span class="at">group =</span> Treatment, <span class="at">color =</span> Treatment)) <span class="sc">+</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype=</span>Treatment),<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1.85</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fl">1.85</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"solid"</span>, <span class="st">"solid"</span>)) <span class="sc">+</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>) ) <span class="sc">+</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.2</span>), <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lees-quant_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<p>Imagine we also collect data on a group of units that were not exposed to the treatment. While treatment assignment was not random, we might think that we can compare how treated units and non-treated units change in order to estimate the effect of the treatment.</p>
</div>
</section>
<section id="why-cant-we-just-compare-units-without-randomization-1" class="level2">
<h2 class="anchored" data-anchor-id="why-cant-we-just-compare-units-without-randomization-1">Why can’t we just compare units without randomization?</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>Year <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>Outcome <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.2</span>, <span class="fl">1.4</span>, <span class="fl">1.6</span>, </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>            <span class="fl">0.9</span>, <span class="fl">1.3</span>, <span class="fl">1.7</span>, <span class="fl">2.1</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>Treatment <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Non-treated"</span>, <span class="st">"Non-treated"</span>,<span class="st">"Non-treated"</span>,<span class="st">"Non-treated"</span>, </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Treatment"</span>, <span class="st">"Treatment"</span>, <span class="st">"Treatment"</span>, <span class="st">"Treatment"</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">=</span> <span class="fu">data.frame</span>(Year, Outcome, Treatment)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dat, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Outcome, <span class="at">group =</span> Treatment, <span class="at">color =</span> Treatment)) <span class="sc">+</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype=</span>Treatment),<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fl">1.85</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"solid"</span>, <span class="st">"solid"</span>)) <span class="sc">+</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>) ) <span class="sc">+</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.85</span>), <span class="at">clip =</span> <span class="st">"on"</span>) <span class="sc">+</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.2</span>), <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lees-quant_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<p>However, because the treatment was not randomly assigned, treated and non-treated units may be systematically different, leading them to have different trajectors before the treatment was administered. When we see a longer period of time, it’s clear that both groups are changing at the same rate that they were prior to the treatment group being exposed to the treatment.</p>
</div>
</section>
<section id="causal-inference-tools" class="level2">
<h2 class="anchored" data-anchor-id="causal-inference-tools">Causal Inference Tools</h2>
<ul>
<li>Randomized experiments
<ul>
<li>Gold-standard</li>
<li>Field and survey</li>
</ul></li>
<li>Observational data
<ul>
<li>Natural experiments</li>
<li>Difference-in-Differences</li>
<li>Matching, Synthetic Control</li>
</ul></li>
</ul>
<div class="notes">
<p>There are several ways that we can estimate causal relationships in the real world. Randomized experiments provide the most reliable way to accomplish this. Under random assignment, the statistically most likely outcome is that treatment and control groups will not have any systematic differences that can confound our ability to estimate the treatment effect.</p>
</div>
</section>
</section>
<section id="randomized-experimentss" class="level1">
<h1>Randomized Experimentss</h1>
<section id="estimating-causal-effects-with-randomized-experiments" class="level2">
<h2 class="anchored" data-anchor-id="estimating-causal-effects-with-randomized-experiments">Estimating Causal Effects with Randomized Experiments</h2>
<ul>
<li>Randomly assigning exposure to the treatment ensures that treatment and control groups are, on average, identical on observed and unobserved pre-treatment characteristics</li>
<li><a href="https://ellaudet.iq.harvard.edu/random_treatment">Check out this interactive visualization</a>
<ul>
<li>Observe how random assignment produces treatment and control groups with a similar composition, especially at larger sample sizes</li>
</ul></li>
</ul>
<div class="notes">
<p>As a reminder, randomly assigning exposure to the treatment ensures that treatment and control groups are, on average, identical on observed and unobserved pre-treatment characteristics. Check out this interactive visualization to see how random assignment produces treatment and control groups with a similar composition, especially at larger sample sizes.</p>
</div>
</section>
<section id="estimating-causal-effects-with-randomized-experiments-1" class="level2">
<h2 class="anchored" data-anchor-id="estimating-causal-effects-with-randomized-experiments-1">Estimating Causal Effects with Randomized Experiments</h2>
<ul>
<li>Best way to estimate causal effect of one variable on another variable</li>
<li>Randomized experiments are used across a wide variety of disciplines, from medicine and pharmacology to marketing and political science</li>
<li>We can randomize different types of treatments
<ul>
<li>Impact evaluations randomly assign an intervention</li>
<li>Survey experiments randomize exposure to images and text</li>
<li>Clinical trials randomly assign randomly assign medical treatments</li>
</ul></li>
</ul>
<div class="notes">
<p>The most straightforward and reliable method for identifying the causal effect of one variable on another is through randomized experiments. Randomized experiments offer us a powerful tool because they allow us to rule-out bias confounding variables, providing a clearer picture of cause and effect relationships. This method is applied across a broad range of fields, and is the foundation for inference in many social and physical science disciplines. For instance, when conducting an impact evaluation, interventions are randomly assigned to different groups to assess their effects. This could be educational programs, economic policies, or health-related initiatives. In survey research, we often randomize exposure to specific images or text to understand how different types of content influence opinions or behaviors. This approach is particularly valuable in areas like marketing or political science, where the impact of media and messaging is critical. Clinical trials are also a form of randomized experiment that’s essential in pharmacology and medical research. Here, medical treatments are assigned randomly to participants to rigorously test their efficacy and safety. By employing randomized experiments, we can draw accurate conclusions about causality, significantly improving the ability of research to inform the design policies and interventions.</p>
</div>
</section>
<section id="limitations-and-ethical-considerations" class="level2">
<h2 class="anchored" data-anchor-id="limitations-and-ethical-considerations">Limitations and Ethical Considerations</h2>
<ul>
<li>IEs are extremely resource-intensive with high opportunity costs
<ul>
<li>Large financial costs and long-evaluation periods</li>
<li>Require deep technical expertise and implementation experience</li>
</ul></li>
<li>Findings may not be generalizable to other contexts or scales
<ul>
<li>Results may not be applicable to different contexts or populations</li>
<li>Challenges in scaling up successful interventions</li>
</ul></li>
<li>Ethical Concerns
<ul>
<li>Control group should receive the status quo</li>
<li>Possible resistance from communities or organizations</li>
<li>Impact on vulnerable populations must be considered explicitly and early</li>
</ul></li>
</ul>
<div class="notes">
<p>While IEs are extremely powerful, they have some important limitations and require serious engagement with potential ethical concerns. Firstly, impact evaluations can be extremely resource-intensive. They require substantial financial investment, extensive data collection, and deep technical expertise and implementation experience. This means that resources might be diverted away from other interventions and research. This can also make them impractical for smaller organizations or interventions with limited budgets. Another limitation is the generalizability of the results. What works well in one specific context or population might not necessarily be effective elsewhere. For this reason, it is necessary to include partners with deep contextual knowledge that can tailor interventions to the context. Relatedly, interventions that are extremely effective with a small group of people might be completely ineffective at a larger scale. Many evaluations have found that wildly successful interventions have no impact when moving from treating a very small proportion of the population to a larger proportion of the population or when moving from or from implementation by an NGO to implementation by a national government agency. Understanding these limitations and ethical considerations is crucial for conducting responsible and effective impact evaluations and for making responsible policy recommendations based on findings. From an ethical standpoint, impact evaluations have several unique features that must be considered. First, the status quo should be maintained for control groups. In other words, it is not acceptable to deny the control group access to something that they had before the evaluation period as part of the research. It is OK to withhold new benefits, but it is never OK to revoke or withdrawal existing benefits. Furthermore, there might be resistance from communities or organizations that feel threatened by the changes proposed through the intervention or are upset about how the treatment is being assigned. Finally, when using random assignment, it is important to consider the potential impact on vulnerable populations. Extra effort must often be made to ensure that random assignment does not accidentally exclude specific populations by virtue of their geographic location or differences in social integration. For example, when an intervention is randomly assigned at the village level, minority groups may be less likely to benefit if they are less socially integrated or actively excluded by local institutions. For more general discussion of ethics in research, including the role of ethical review boards, see the Overview for this module.</p>
</div>
</section>
<section id="dealing-with-small-sample-sizes" class="level2">
<h2 class="anchored" data-anchor-id="dealing-with-small-sample-sizes">Dealing with Small Sample Sizes</h2>
<ul>
<li>Budget limitations often lead to small sample sizes</li>
<li>Small samples reduce statistical precision and may result in groups that are less comparable</li>
<li>There are tools to ensure balance on observed characteristics
<ul>
<li>Re-randomization</li>
<li>Blocking</li>
<li>Non-bipartite matching</li>
</ul></li>
</ul>
<div class="notes">
<p>One common challenge for IEs is having a small sample size. Because IEs are expensive, researchers often need to limit the number of subjects (whether they’re individuals, communities, or organizations) involved in an evaluation. Small sample sizes can reduce the statistical precision of our evaluation, and may result in an evaluation that is unable to distinguish a small impact from no impact. This severely limits our ability to learn from the research. Similarly, randomizing assignment among a small sample increases the risk that our treatment and control groups will be systematically different on pre-treatment characteristics, which can produce misleading results. Think back to the interactive visualization on the first slide of this tutorial.</p>
<p>However, there are some advanced methods to reduce the risks associated with small sample sizes in randomized evaluations. However, all of these methods require researchers to have pre-treatment baseline data about the subjects among which assignment is being randomized.</p>
<p>First, we have Re-randomization. This technique involves randomizing the treatment assignment multiple times and selecting the assignment that returns the best balance across assignment, as measured by baseline data on subject characteristics. It’s particularly useful when you’re working with a limited number of participants but still want to ensure a fair distribution of characteristics.</p>
<p>Next is Blocking. In blocking, we group participants with similar characteristics together before randomly assigning treatments within these blocks. This method reduces variability between the groups, improving the efficiency and balance of our comparisons, which is crucial in studies with small sample sizes.</p>
<p>We also have Non-bipartite Matching. This approach matches participants in treatment and control groups based on similar characteristics, allowing for more flexibility and potentially better balance across a large range of pre-treatment characteristics. However, this method can be complex and computationally intensive.</p>
<p>It’s important to note that these methods—despite being quite sophisticated—primarily ensure balance on observed characteristics. This means they help us control for known variables, but there may still be unobserved variables that could influence the outcomes.</p>
<p>In summary, while these methods enhance the reliability of our results within the constraints of small sample sizes, they do not completely eliminate the limitations associated with unobserved factors. It’s essential to interpret results with an understanding of both the strengths and the limitations of these statistical techniques.”</p>
</div>
</section>
<section id="validity" class="level2">
<h2 class="anchored" data-anchor-id="validity">Validity</h2>
<div class="incremental">
<ul class="incremental">
<li>Internal validity</li>
<li>External validity</li>
<li>What are the trade-offs between experiments and observational studies?
<ul class="incremental">
<li>Experiments have more internal validity</li>
<li>But… they often have synthetic treatments, convenience samples</li>
</ul></li>
<li>Where are these studies used in the real-world?</li>
</ul>
</div>
</section>
<section id="additional-resources" class="level2">
<h2 class="anchored" data-anchor-id="additional-resources">Additional Resources</h2>
<ul>
<li>For a deeper-dive on impact evaluations, see these teaching resources created by J-PAL: https://www.povertyactionlab.org/resource/teaching-resources-randomized-evaluations</li>
</ul>
</section>
</section>
<section id="causal-inference-with-observational-data" class="level1">
<h1>Causal Inference with Observational Data</h1>
<section id="causality-without-randomization" class="level2">
<h2 class="anchored" data-anchor-id="causality-without-randomization">Causality without Randomization</h2>
<div class="incremental">
<ul class="incremental">
<li>You must control for…
<ul class="incremental">
<li>everything (observed and unobserved) that affects both the treatment variable and the outcome variable</li>
</ul></li>
<li>You <em>must not</em> control for…
<ul class="incremental">
<li>anything that is affected by both the treatment variable and the outcome variable</li>
</ul></li>
<li>You <em>need to think carefully before</em> controlling for…
<ul class="incremental">
<li>anything that is affected by the treatment variable that also affects the outcome variable</li>
</ul></li>
</ul>
</div>
<div class="notes">
<p>There are many contexts in which randomized controlled trials are not feasible. Fortunately, causal inference is also possible without random assignment. However, these tools require very precise conditions and can be difficult to implement without significant background in causal inference methods. For this reason, we provide a high-level overview so that researchers can seek-out more information on methods that seem relevant to their work.</p>
<p>Causal inference with observational data (situations where researchers did not actively manipulate how the treatment was assigned) has been a rapidly growing area of research in the social sciences since the 1990s. There are several specific tools used in this field, each of which rely on specific conditions in the world, many of which are fare. For example, many researchers look for situations in the world that resemble experiments due to naturally occuring random assignment, such as lotteries or discontinuities in exposure, variation in exposure to treatment over time, or creating balance on observable characteristics through matching and weighting procedures. While these methods all have weaknesses, they are essential causal inference tools for social science research.</p>
</div>
</section>
<section id="identification-strategy" class="level2">
<h2 class="anchored" data-anchor-id="identification-strategy">Identification strategy</h2>
<p><strong>In the real world, there are always threats to inference that we can’t measure/observe or understand well enough to adjust for</strong></p>
<ul>
<li>A <em>research design</em> that allows us to isolate a causal effect from observational data</li>
<li>Approximates an experiment by ensuring that the treatment and control group are similar at baseline</li>
<li>These strategies rely on assumptions that we can <em>attempt</em> to validate</li>
</ul>
<div class="notes">
<p>In the real world, the main challenge with observational data is the multitude of threats to valid inference—factors we can’t measure, observe, or perhaps even understand sufficiently to adjust for. These threats can bias our results and lead to incorrect conclusions. To tackle this, researchers employ specific research designs that allow us to approximate the conditions of an experiment. These designs ensure that the treatment and control groups are as similar as possible at baseline. By doing this, we aim to isolate the variable of interest and measure its true effect on the outcome. However, it’s important to recognize that these strategies are not foolproof. They rely heavily on assumptions that we need to critically evaluate and attempt to validate.</p>
</div>
</section>
<section id="holy-trinity-of-causal-inference" class="level2">
<h2 class="anchored" data-anchor-id="holy-trinity-of-causal-inference">Holy Trinity of Causal Inference</h2>
<p><br>
</p>
<ol type="1">
<li><strong>Difference-in-Differences</strong></li>
<li>Regression Discontinuity</li>
<li>Instrumental Variables</li>
</ol>
<div class="notes">
<p>The ‘Holy Trinity of Causal Inference’ is a term we use to describe three powerful research designs that help us establish causality in economics and social sciences when randomized controlled trials are not possible. These methods are Difference-in-Differences, Regression Discontinuity, and Instrumental Variables. Each of these methods relies on specific assumptions and conditions to validly infer causality. Their strength lies in their ability to provide insights into causal relationships even when experiments are impractical or unethical. It’s crucial, however, to ensure that the assumptions behind each method are met in the context of your specific study.” In this tutorial, we will focus on DiD because it is the most commonly used tool and the easiest to implement. We briefly discuss regression-discontinuity. We do not discuss Instrumental variables, because they are rarely applicable in applied research.</p>
</div>
</section>
<section id="identification-strategy-1" class="level2">
<h2 class="anchored" data-anchor-id="identification-strategy-1">Identification strategy</h2>
<p><strong>In the real world, there are always threats to inference that we can’t measure/observe or understand well enough to adjust for</strong></p>
<ul>
<li>A <em>research design</em> that allows us to isolate a causal effect from observational data</li>
<li>Approximates an experiment by ensuring that the treatment and control group are similar at baseline</li>
<li>These strategies rely on assumptions that we can <em>attempt</em> to validate</li>
</ul>
</section>
<section id="difference-in-differences" class="level2">
<h2 class="anchored" data-anchor-id="difference-in-differences">Difference-in-Differences</h2>
<p><br>
</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>Y_{it} = \alpha + \beta_1 \text{Treatment}_i + \beta_2 \text{Post}_t + \gamma (\text{Treatment}_i \times \text{Post}_t) + \epsilon_{it}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><code>\gamma (\text{Treatment}_i \times \text{Post}_t)</code></li>
<li>Assumes measurement at two points in time</li>
</ul>
<div class="notes">
<p>We begin with Difference-in-Differences (DiD). This method is used when we have data from both before and after an intervention, for both a treatment group and a control group. By comparing the changes in outcomes over time between these groups, DiD helps us isolate the effect of the intervention from other factors that are changing over time. The Difference-in-Differences (DiD) approach is a quasi-experimental technique used in econometrics and statistics to estimate the effect of a specific intervention or treatment by comparing the changes in outcomes over time between a group that’s exposed to the intervention (treatment group) and a group that is not (control group). The equation on this slide represents a basic DiD model: Yit=α+β1Treatmenti+β2Postt+γ(Treatmenti×Postt)+ϵitYit=α+β1Treatmenti+β2Postt+γ(Treatmenti×Postt)+ϵit Here’s what each term represents: - Yit is the outcome variable for unit i at time t. - α is the constant term or the baseline level of the outcome. - Treatmenti is an indicator variable that equals 1 if the observation ii belongs to the treatment group, and 0 otherwise. - Postt is an indicator for the post-treatment period, equaling 1 if the observation is after the intervention has been implemented, and 0 if before. - γ is the coefficient of interest, which represents the interaction between the treatment and the post period. This interaction term captures the differential effect of the treatment over time compared to the control group. - ϵit is the error term.</p>
</div>
</section>
<section id="simulation-example" class="level2">
<h2 class="anchored" data-anchor-id="simulation-example">Simulation Example</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate example data</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="at">each =</span> <span class="dv">100</span>),</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">post =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="at">each =</span> <span class="dv">50</span>, <span class="at">times =</span> <span class="dv">2</span>),</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">2</span>), <span class="co"># control: pre-treatment</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">2</span>), <span class="co"># control: post-treatment</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">2</span>), <span class="co"># treatment: pre-treatment</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">12</span>, <span class="at">sd =</span> <span class="dv">2</span>)) <span class="co"># treatment: post-treatment</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  treatment post   outcome
1         1    1  8.879049
2         1    1  9.539645
3         1    1 13.117417
4         1    1 10.141017
5         1    1 10.258575
6         1    1 13.430130</code></pre>
</div>
</div>
<div class="notes">
<p>We begin by illustrating the Difference-in-Differences (DiD) method using a simulation example in R. This approach will help us understand how to implement DiD and interpret its output practically. By simulating data that mimics a controlled experiment, we can visually comprehend how DiD estimates the effect of an intervention First, we load two essential R libraries. dplyr is used for data manipulation, and modelsummary will help us to summarize models easily and produce nice tables for our results. Then we set the seed of R’s random number generator, which helps in ensuring that the results are reproducible. The same set of random numbers can be generated again, which is crucial for simulations. Next, we generate a dataset with three variables: - treatment: A binary variable where 1 represents the treatment group and 0 represents the control group. It’s repeated 100 times to match the number of observations. - post: A binary variable indicating whether the observation is post-treatment (1) or pre-treatment (0). It is repeated 50 times and cycled twice to align with the treatment periods. - outcome: The outcome variable, generated using a normal distribution. The means and standard deviations are set to simulate the effect of the treatment over time. The treatment group in the post-treatment period has a higher mean (12) compared to the pre-treatment period (10), which illustrates the impact of the intervention. This simulation setup allows us to apply the DiD analysis on a dataset where we know the true impact of the intervention, thus providing a clear way to evaluate the effectiveness of the DiD method. By comparing the outcomes before and after the treatment in both the treated and control groups, we can observe how the DiD estimator works in practice.</p>
</div>
</section>
<section id="simulation-example-1" class="level2">
<h2 class="anchored" data-anchor-id="simulation-example-1">Simulation Example</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run difference-in-differences model</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>did_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(outcome <span class="sc">~</span> treatment <span class="sc">*</span> post, <span class="at">data =</span> data)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the output</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="fu">lm</span>(outcome <span class="sc">~</span> treatment <span class="sc">+</span> post, <span class="at">data =</span> data), <span class="fu">lm</span>(outcome <span class="sc">~</span> treatment <span class="sc">*</span> post, <span class="at">data =</span> data)),</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate  =</span> <span class="st">"{estimate}{stars} ({std.error})"</span>,</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">statistic =</span> <span class="cn">NULL</span>,</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">gof_omit =</span> <span class="st">'IC|RMSE|Log|F|R2$|Std.'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Model 1</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Model 2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">11.487*** (0.241)</td>
<td style="text-align: center;">12.078*** (0.265)</td>
</tr>
<tr class="even">
<td style="text-align: left;">treatment</td>
<td style="text-align: center;">−0.604* (0.278)</td>
<td style="text-align: center;">−1.785*** (0.375)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">post</td>
<td style="text-align: center;">−1.405*** (0.278)</td>
<td style="text-align: center;">−2.585*** (0.375)</td>
</tr>
<tr class="even">
<td style="text-align: left; box-shadow: 0px 1px;">treatment × post</td>
<td style="text-align: center; box-shadow: 0px 1px;"></td>
<td style="text-align: center; box-shadow: 0px 1px;">2.361*** (0.531)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Num.Obs.</td>
<td style="text-align: center;">200</td>
<td style="text-align: center;">200</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2 Adj.</td>
<td style="text-align: center;">0.124</td>
<td style="text-align: center;">0.201</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="notes">
<p>Finally, we estimate the difference in difference model and interpret the results. The first line of code fits a linear regression model (lm) where the outcome variable is regressed on the interactions between the treatment and post variables. The treatment * post syntax includes both the main effects of the treatment and post variables and their interaction term. This interaction term is the key to the DiD analysis, as it estimates the additional effect of being in the treatment group post-intervention relative to pre-intervention and control group changes. The next block uses the modelsummary function to create a summarized table of the model outputs: - List of Models: Two models are summarized here. The first is a simpler model without the interaction term, and the second is the full DiD model. - Estimate Formatting: The output format includes the estimated coefficients ({estimate}), significance stars ({stars}), and standard errors ({std.error}) in parentheses. - Goodness of Fit (gof) Omissions: The gof_omit parameter specifies which model fit indicators to omit from the summary, such as - - Information Criteria (IC), Root Mean Square Error (RMSE), etc. - Output: The summary is set to be outputted as a PowerPoint table (table.pptx), which is useful for presentation purposes.</p>
<p>Finally, we interpret the results</p>
<p>Coefficients: Look for the coefficient of the interaction term (treatment:post). This coefficient tells you the estimated effect of the treatment, adjusted for baseline differences and trends over time. Significance: Significance levels (indicated by stars) give an idea of the statistical significance of the estimates. Commonly, * p&lt;0.05, ** p&lt;0.01, *** p&lt;0.001. Standard Errors: These provide a measure of the variability of the coefficient estimates. Smaller standard errors suggest more precise estimates.</p>
<p>If the interaction term is statistically significant and positive, it suggests that the treatment had a positive effect on the outcome, over and above any baseline or time-related effects. The size of the coefficient on the interaction term quantifies the magnitude of this effect. Comparing the two models in the summary (with and without the interaction term) can also provide insights into the importance of considering the interaction between treatment and time for capturing the causal effect accurately.</p>
<p>Here, we focus on Model 2, which is the differences-in-differences model:</p>
<p>The intercept (12.078)* represents the adjusted average baseline outcome for the control group before the intervention, slightly higher here due to adjustments in the model. The treatment (-1.785)* indicator coefficient is significantly larger and still negative, which reinforces the observation that the treatment group was initially performing worse than the control group. The post (-2.585)* coefficient indicates a substantial decline in the outcome for the control group in the post-treatment period, even more pronounced than in Model 1.</p>
<p>The crucial insight from Model 2 is the interaction term (Treatment × Post), which indicates that the treatment effectively improved outcomes by about 2.361 units in the post period, relative to what would have been expected based on the pre-period trends and the initial negative impact of the treatment. This suggests the treatment’s effectiveness becomes apparent only when considering its temporal implementation.</p>
</div>
</section>
<section id="did-assumptions" class="level2">
<h2 class="anchored" data-anchor-id="did-assumptions">DiD: Assumptions</h2>
<ul>
<li>Assumption
<ul>
<li>Parallel Trends: Treatment and control units would have changed in similar ways without exposure to the treatment</li>
</ul></li>
<li>Limitations
<ul>
<li>Requires at least two pre-treatment observations and one post-treatment observation (observations at 3 time points)</li>
<li>Cannot rule-out confounders that only affect the treatment group and are simultaneous with the treatment</li>
<li>Estimation is more complicated when conditions change</li>
</ul></li>
</ul>
<div class="notes">
<p>While DiD is widely used, it comes with some important assumptions and limitations. The Parallel Trends Assumption is critical and assumes that in the absence of treatment, the average outcomes for the treated and control groups would have followed parallel paths over time. This means any difference between these groups over time can be attributed to the treatment and not to other factors. To validate the parallel trends assumption, we need data for at least two time points before the intervention. More time points can increase the robustness of the model by allowing for more complex specifications and validation of the parallel trends assumption. The simplicity of DiD can also be a limitation. For instance, if other events affect the treated and control groups differently at the same time as the treatment (confounding events), this can bias the results. Moreover, the method only ensures balance on observed characteristics; unobserved biases that vary over time can still affect the outcome.</p>
<p>Finally, estimation can get much more complicated when the treatment affects different treatment units at different times or when the treatment “turns on and off”.</p>
</div>
</section>
<section id="why-cant-we-just-observe-how-units-change-over-time-2" class="level2">
<h2 class="anchored" data-anchor-id="why-cant-we-just-observe-how-units-change-over-time-2">Why can’t we just observe how units change over time?</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>Year <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>Outcome <span class="ot">=</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fl">1.3</span>, <span class="fl">1.7</span>, <span class="cn">NA</span>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>Treatment <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Treatment"</span>, <span class="st">"Treatment"</span>,<span class="st">"Treatment"</span>,<span class="st">"Treatment"</span>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">=</span> <span class="fu">data.frame</span>(Year, Outcome, Treatment)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dat, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Outcome, <span class="at">group =</span> Treatment, <span class="at">color =</span> Treatment)) <span class="sc">+</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype=</span>Treatment),<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fl">0.8</span>, <span class="fl">2.2</span>) <span class="sc">+</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"solid"</span>, <span class="st">"solid"</span>)) <span class="sc">+</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>) ) <span class="sc">+</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.2</span>), <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lees-quant_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<p>In the following slides, we visualize the logic of difference-in-difference designs. Imagine we have a treatment that was administered in between data collection in Year 1 and Year 2. Traditional evaluations often measure treatment units before and after an intervention</p>
</div>
</section>
<section id="why-cant-we-just-observe-how-units-change-over-time-3" class="level2">
<h2 class="anchored" data-anchor-id="why-cant-we-just-observe-how-units-change-over-time-3">Why can’t we just observe how units change over time?</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>Year <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>Outcome <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">1.3</span>, <span class="fl">1.7</span>, <span class="fl">2.1</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>Treatment <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Treatment"</span>, <span class="st">"Treatment"</span>,<span class="st">"Treatment"</span>,<span class="st">"Treatment"</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">=</span> <span class="fu">data.frame</span>(Year, Outcome, Treatment)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dat, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Outcome, <span class="at">group =</span> Treatment, <span class="at">color =</span> Treatment)) <span class="sc">+</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype=</span>Treatment),<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fl">0.8</span>, <span class="fl">2.2</span>) <span class="sc">+</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"solid"</span>, <span class="st">"solid"</span>)) <span class="sc">+</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>) ) <span class="sc">+</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.2</span>), <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lees-quant_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<p>However, this method can’t rule-out the possibility that the treatment group was already improving at a steady pace, and would have improved by the same amount in the absence of the intervention. Here, we see that the blue line followed a consistent trend throughout the entire period, we it doesn’t look like the intervention had anything to do with the improvement between Y1 and Y2.</p>
</div>
</section>
<section id="why-cant-we-just-compare-units-without-randomization-2" class="level2">
<h2 class="anchored" data-anchor-id="why-cant-we-just-compare-units-without-randomization-2">Why can’t we just compare units without randomization?</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>Year <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>Outcome <span class="ot">=</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fl">1.2</span>, <span class="fl">1.4</span>, <span class="cn">NA</span>, </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>            <span class="cn">NA</span>, <span class="fl">1.3</span>, <span class="fl">1.7</span>, <span class="cn">NA</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>Treatment <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Control"</span>, <span class="st">"Control"</span>,<span class="st">"Control"</span>,<span class="st">"Control"</span>, </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Treatment"</span>, <span class="st">"Treatment"</span>, <span class="st">"Treatment"</span>, <span class="st">"Treatment"</span>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">=</span> <span class="fu">data.frame</span>(Year, Outcome, Treatment)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>Treatment <span class="ot">=</span> <span class="fu">factor</span>(dat<span class="sc">$</span>Treatment, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Treatment"</span>, <span class="st">"Control"</span>))</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dat, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Outcome, <span class="at">group =</span> Treatment, <span class="at">color =</span> Treatment)) <span class="sc">+</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype=</span>Treatment),<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fl">0.8</span>, <span class="fl">2.2</span>) <span class="sc">+</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"solid"</span>, <span class="st">"solid"</span>)) <span class="sc">+</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>) ) <span class="sc">+</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.2</span>), <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lees-quant_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<p>One solution is to have a comparison group that did not receive the treatment. Here, we see that the improvement between Y1 and Y2 was larger for the treatment group, suggesting there may have been an effect of the treatment.</p>
</div>
</section>
<section id="why-cant-we-just-compare-units-without-randomization-3" class="level2">
<h2 class="anchored" data-anchor-id="why-cant-we-just-compare-units-without-randomization-3">Why can’t we just compare units without randomization?</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>Year <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>Outcome <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.2</span>, <span class="fl">1.4</span>, <span class="fl">1.6</span>, </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>            <span class="fl">0.9</span>, <span class="fl">1.3</span>, <span class="fl">1.7</span>, <span class="fl">2.1</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>Treatment <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Control"</span>, <span class="st">"Control"</span>,<span class="st">"Control"</span>,<span class="st">"Control"</span>, </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Treatment"</span>, <span class="st">"Treatment"</span>, <span class="st">"Treatment"</span>, <span class="st">"Treatment"</span>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">=</span> <span class="fu">data.frame</span>(Year, Outcome, Treatment)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>Treatment <span class="ot">=</span> <span class="fu">factor</span>(dat<span class="sc">$</span>Treatment, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Treatment"</span>, <span class="st">"Control"</span>))</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dat, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Outcome, <span class="at">group =</span> Treatment, <span class="at">color =</span> Treatment)) <span class="sc">+</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype=</span>Treatment),<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fl">0.8</span>, <span class="fl">2.2</span>) <span class="sc">+</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"solid"</span>, <span class="st">"solid"</span>)) <span class="sc">+</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>) ) <span class="sc">+</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.2</span>), <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lees-quant_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<p>However, if the treatment was not randomly assigned, we can’t be confident that these groups would have changed in similar ways without the intervention. In this example, the control group was improving more slowly before the intervention, suggesting that the treatment did not have any effect on the improvement of the treatment group.</p>
</div>
</section>
<section id="why-cant-we-just-compare-units-without-randomization-4" class="level2">
<h2 class="anchored" data-anchor-id="why-cant-we-just-compare-units-without-randomization-4">Why can’t we just compare units without randomization?</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>Year <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>Outcome <span class="ot">=</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fl">1.3</span>, <span class="fl">1.5</span>, <span class="cn">NA</span>,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>            <span class="dv">1</span>, <span class="fl">1.2</span>, <span class="fl">1.4</span>, <span class="cn">NA</span>,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>            <span class="fl">1.1</span>, <span class="fl">1.3</span>, <span class="fl">1.7</span>, <span class="cn">NA</span>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>Treatment <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Comparison"</span>,<span class="st">"Comparison"</span>,<span class="st">"Comparison"</span>,<span class="st">"Comparison"</span>,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Control"</span>, <span class="st">"Control"</span>,<span class="st">"Control"</span>,<span class="st">"Control"</span>,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Treatment"</span>, <span class="st">"Treatment"</span>, <span class="st">"Treatment"</span>, <span class="st">"Treatment"</span>)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">=</span> <span class="fu">data.frame</span>(Year, Outcome, Treatment)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>Treatment <span class="ot">=</span> <span class="fu">factor</span>(dat<span class="sc">$</span>Treatment, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Treatment"</span>, <span class="st">"Comparison"</span>, <span class="st">"Control"</span>))</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dat, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Outcome,  <span class="at">color =</span> Treatment)) <span class="sc">+</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype=</span>Treatment),<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fl">0.8</span>, <span class="fl">2.2</span>) <span class="sc">+</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"solid"</span>, <span class="st">"dotted"</span>, <span class="st">"solid"</span>)) <span class="sc">+</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"black"</span>, <span class="st">"red"</span>  ) ) <span class="sc">+</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.2</span>), <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lees-quant_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<p>Difference-in-differences allows us to confirm whether or not the treatment and control group were changing at a similar rate before the treatment was administered (known as parallel trends). If the size of this change increases more for the treatment group than it does for the control group, we can consider this strong evidence for a causal effect of the treatment.</p>
</div>
</section>
<section id="why-cant-we-just-compare-units-without-randomization-5" class="level2">
<h2 class="anchored" data-anchor-id="why-cant-we-just-compare-units-without-randomization-5">Why can’t we just compare units without randomization?</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>Year <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>Outcome <span class="ot">=</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fl">1.3</span>, <span class="fl">1.5</span>, <span class="fl">1.7</span>,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>            <span class="dv">1</span>, <span class="fl">1.2</span>, <span class="fl">1.4</span>,<span class="fl">1.6</span>,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>            <span class="fl">1.1</span>, <span class="fl">1.3</span>, <span class="fl">1.7</span>, <span class="fl">1.9</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>Treatment <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Comparison"</span>,<span class="st">"Comparison"</span>,<span class="st">"Comparison"</span>,<span class="st">"Comparison"</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Control"</span>, <span class="st">"Control"</span>,<span class="st">"Control"</span>,<span class="st">"Control"</span>,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Treatment"</span>, <span class="st">"Treatment"</span>, <span class="st">"Treatment"</span>, <span class="st">"Treatment"</span>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">=</span> <span class="fu">data.frame</span>(Year, Outcome, Treatment)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>Treatment <span class="ot">=</span> <span class="fu">factor</span>(dat<span class="sc">$</span>Treatment, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Treatment"</span>, <span class="st">"Comparison"</span>, <span class="st">"Control"</span>))</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dat, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Outcome,  <span class="at">color =</span> Treatment)) <span class="sc">+</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype=</span>Treatment),<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fl">0.8</span>, <span class="fl">2.2</span>) <span class="sc">+</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"solid"</span>, <span class="st">"dotted"</span>, <span class="st">"solid"</span>)) <span class="sc">+</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"black"</span>, <span class="st">"red"</span>  ) ) <span class="sc">+</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.2</span>), <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lees-quant_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<p>Observations for more time periods allow us to be more confident in these findings.</p>
</div>
</section>
<section id="regression-discontinuity-designs" class="level2">
<h2 class="anchored" data-anchor-id="regression-discontinuity-designs">Regression Discontinuity Designs</h2>
<ul>
<li>Estimating causal effects using a naturally occurring cutoff or threshold that determines which subjects are exposed to a treatment</li>
<li>Assumes that subjects just below and just above are similar on all characteristics aside from receiving the treatment</li>
<li>Allows researchers to estimate a Local Average Treatment Effect (LATE)</li>
</ul>
<div class="notes">
<p>The main idea of RDD is to estimate causal effects by taking advantage of a naturally occurring cutoff or threshold. This could be something like a test score determining eligibility for a scholarship, where the cutoff score is the threshold. In RDD, we make a critical assumption: individuals who are just below and just above this cutoff are similar in all respects except for the exposure to the treatment. This assumption is crucial because it implies that any differences observed between these two groups can be attributed to the treatment effect and not to other underlying differences. It must be the case that subjects cannot change their behavior to ensure that they fall on one side of the cutoff instead of the other, which we refer to as “sorting”. Using RDD allows researchers to estimate what we call the Local Average Treatment Effect, or LATE. This measure tells us the effect of the treatment on those who are precisely at the threshold—those who are affected by being just above or just below the cutoff. It is important to note that this effect may not generalize to individuals further from the threshold. This method is particularly powerful in settings where randomized control trials are impractical or unethical. It provides a robust way to measure the impact of treatments or interventions in a natural setting, making it a valuable tool in our statistical toolbox.</p>
</div>
</section>
<section id="example" class="level2">
<h2 class="anchored" data-anchor-id="example">Example</h2>
<ul>
<li>Exploring the effect of a merit-based scholarship to attend college on future earnings</li>
<li>We are interested in this relation:
<ul>
<li>A[Merit-based Scholarship] –&gt; B[Earnings after college]</li>
</ul></li>
<li>Suppose we run a regression such as:</li>
</ul>
<p><code>Earnings_i = \alpha + \beta \times Scholarship_i + \epsilon_i</code></p>
<p>Problems? - <strong>Confounding</strong>: People who earn merit-based scholarships are different than those who do not in important ways: in grades, in abilities, in drive…</p>
<div class="notes">
<p>Let’s use a practical example to illustrate the concept of causality in statistical research. We are focusing on the effect of a merit-based scholarship on future earnings after college.</p>
<p>Imagine we want to analyze whether receiving a merit-based scholarship to attend college influences a person’s earnings after they graduate. The relationship we’re interested in is straightforward: does the scholarship lead to higher earnings? To explore this, one might think about running a simple regression model where earnings after college depend on whether a person received a scholarship. The model might look something like this:</p>
<p>Earningsi=α+β×Scholarshipi+ϵiEarningsi=α+β×Scholarshipi+ϵi</p>
<p>Here, αα represents the baseline earnings, ββ represents the effect of the scholarship, and ϵiϵi is the error term.</p>
<p>However, there’s a significant problem with this approach: confounding variables. People who earn merit-based scholarships are likely different from those who do not in several important ways. They might have higher grades, better test scores, or more drive and ambition. These differences can influence their future earnings independently of the scholarship. Thus, any analysis that doesn’t account for these factors might mistakenly attribute the effect of these underlying characteristics to the scholarship itself. This is a classic example of the confounding problem in causal inference.</p>
</div>
</section>
<section id="example-1" class="level2">
<h2 class="anchored" data-anchor-id="example-1">Example</h2>
<ul>
<li>Example: effect of a merit-based scholarship to attend college on future earnings</li>
<li>Suppose we know that scholarships are assigned based on a score.
<ul>
<li>A[Score] –&gt; B[Merit-based Scholarship] –&gt; C[Earnings after college]</li>
</ul></li>
<li>…and there is a strict rule to allocate scholarships:
<ul>
<li>If score &gt; (c_0) → Scholarship</li>
<li>If score ≤ (c_0) → No Scholarship</li>
</ul></li>
<li>Students just below (c_0) and just above (c_0) are likely to be very similar.</li>
<li>Therefore, for people within small bandwidth around the (c_0) threshold we can estimate a <strong>Local Average Treatment Effect</strong>.</li>
</ul>
<div class="notes">
<p>Imagine scholarships are assigned based on a score, and there’s a strict rule for allocation: if a student’s score is above a certain threshold, c0, they receive a scholarship; if it’s below, they do not.</p>
<p>The key here is that students just below and just above the threshold, c0, are very similar in all respects except for the receipt of the scholarship. This similarity allows us to make a clear comparison, focusing on the effect of the scholarship alone, without the confounding factors we discussed earlier.</p>
<p>Given this setup, we can apply a Regression Discontinuity Design. We focus on students within a small bandwidth around the threshold score. This allows us to estimate what’s known as the Local Average Treatment Effect, or LATE. The LATE gives us insights into the impact of the scholarship on those students who are right around the cutoff—those who just qualify and those who just miss out.</p>
<p>This method is powerful because it closely mimics a randomized experiment, the gold standard in causal inference, by comparing very similar individuals who differ only in the treatment received—here, the scholarship based on their score relative to c0c0.</p>
</div>
</section>
<section id="example-2" class="level2">
<h2 class="anchored" data-anchor-id="example-2">Example</h2>
<p><img src="img/rdd3.png" class="fragment img-fluid"></p>
</section>
<section id="adjusting-on-observables" class="level2">
<h2 class="anchored" data-anchor-id="adjusting-on-observables">Adjusting on Observables</h2>
<ul>
<li>Focuses analysis on units with characteristics that are common in both the treatment and control group
<ul>
<li>Assumes that units similar on observed characteristics are also similar on unobserved characteristics (Ignorability)</li>
<li>Benefits from large samples</li>
</ul></li>
<li>Matching
<ul>
<li>Genetic matching, Propensity score matching</li>
</ul></li>
<li>Weighting
<ul>
<li>Entropy Balancing, Inverse probability weighting, Synthetic control</li>
</ul></li>
</ul>
<div class="notes">
<p>Adjusting on observable characteristic can be useful where randomization is not possible and we do not have a cutoff in the assignment of a treatment. Matching or weighting involves pairing or grouping units—like individuals, schools, or communities—based on similar observable characteristics. The goal here is to create equivalent groups that mimic the conditions of a randomized experiment by focusing our analysis on units with characteristics that are common in both the treatment and control group. This approach is particularly useful in observational studies. For example, in healthcare research, patients receiving different treatments can be matched based on variables such as age, pre-existing conditions, and lifestyle choices to assess the effectiveness of a new drug or treatment protocol. Matching and weighting techniques rely on the assumption of “ignorability” or “conditional independence assumption” (CIA). This assumption holds that once you control for the observed covariates, the assignment to the treatment group is as good as random. In practical terms, this means all confounders must be observed and correctly measured so that any two units with the same values on observed covariates have the same potential outcomes irrespective of treatment status. In other words, the key assumption underpinning this method is that units matched on observables are comparable. However, it is impossible to validate this assumption, posing a fundamental limitation of this method. Many matching and weighting methods, particularly those that rely on propensity scores, perform better with large samples. In smaller samples, these methods may struggle to find appropriate matches, reducing the statistical power of the study and increasing the variance of the estimate. Importantly, these methods can be paired with DiD designs to make the parallel trends assumption more realistic.</p>
</div>
</section>
</section>
<section id="multiple-hypothesis-testing" class="level1">
<h1>Multiple Hypothesis Testing</h1>
<section id="statistical-power" class="level2">
<h2 class="anchored" data-anchor-id="statistical-power">Statistical Power</h2>
<ul>
<li><strong>Statistical Power</strong>: The probability that a statistical test will correctly detect a treatment effect when there actually is one</li>
<li><strong>Factors Affecting Power</strong>:
<ul>
<li><strong>Sample Size</strong>: Larger samples generally increase power.</li>
<li><strong>Effect Size</strong>: Larger effects are easier to detect.</li>
<li><strong>Significance Level</strong>: Lower <span class="math inline">\(\alpha\)</span> levels reduce power, though they decrease the risk of false positives.</li>
<li><strong>Variability</strong>: Less variability (i.e., lower standard deviation) in data increases power.</li>
</ul></li>
</ul>
<div class="notes">
<p>Statistical power is fundamental to the design and interpretation of any research study. Statistical power is defined as the probability that our test will correctly reject a false null hypothesis. In simpler terms, it’s the likelihood that our study will actually detect an effect if there is one to be found. Why is power important? Without sufficient power, our study might miss detecting real effects, leading to what we call a Type II error, or a false negative. This means we might conclude there is no effect when, in fact, there is one. If a treatment has a positive impact, but we conclude that it doesn’t, this can waste valuable resources and deprive people of welfare-enhancing benefits. Several key factors influence the power of a statistical test. First, the sample size: larger sample sizes increase the power of a test, improving our chances of detecting an effect. Second, the effect size: if the effect we are looking for is larger, it will be easier to detect. Third, the significance level, typically set at 0.05 for many tests. Lowering this level makes it harder to achieve statistical significance, which can reduce power, though it also makes it less likely to get a false positive. Lastly, variability in our data: less variability means our effects are more discernible, which increases power. Therefore, it’s crucial to conduct a power analysis during the design phase of a study. This analysis will help us determine the necessary sample size and other parameters to ensure our study has adequate power to detect meaningful effects. By planning for power, we maximize the reliability and validity of our research findings</p>
</div>
</section>
<section id="statistical-power-1" class="level2">
<h2 class="anchored" data-anchor-id="statistical-power-1">Statistical Power</h2>
<ul>
<li><strong>Planning for Power</strong>: Conduct power analyses before study design to determine the necessary sample size to achieve adequate power.</li>
<li><strong>Many tools exist to estimate the power of your research design</strong>:
<ul>
<li>This tool from EGAP is a good starting point: <a href="https://egap.shinyapps.io/power-app/">https://egap.shinyapps.io/power-app/</a></li>
<li>Researchers with more sophisticated designs should check out the <code>declaredesign</code> package for R.</li>
</ul></li>
</ul>
<div class="notes">
<p>Planning for statistical power is critical because it allows us to determine the necessary sample size and other parameters needed to achieve adequate power in our study. By conducting power analyses before the study design, we ensure that our study is capable of detecting the effects we are interested in observing, thus reducing the risk of Type II errors—failing to detect an effect when there actually is one. To aid in these analyses, there are numerous tools available that can estimate the power of your research design. One accessible tool that I recommend for those starting out is the EGAP Power Analysis Tool, which you can find online. This tool is user-friendly and can be very helpful in preliminary power calculations. For those involved in more sophisticated study designs, I suggest exploring the ‘DeclareDesign’ package for R. This package allows for a more detailed and nuanced approach to planning your study, taking into account complex design elements and providing a robust framework for understanding the interplay between design decisions and statistical power.</p>
</div>
</section>
<section id="multiple-hypothesis-tests" class="level2">
<h2 class="anchored" data-anchor-id="multiple-hypothesis-tests">Multiple Hypothesis Tests</h2>
<ul>
<li>Researchers usually want to measure important outcomes in multiple ways</li>
<li>Testing the same hypothesis with multiple separate measures will increase the probability of mistakenly finding a positive effect even</li>
<li>Traditional correction methods can reduce statistical power</li>
<li>Index measures can help to avoid these problems</li>
</ul>
<div class="notes">
<p>Researchers usually want to measure important outcomes in multiple ways. This can be extremely important. Any individual approach to measuring an outcome might be subject to unexpected measurement error. For example, if we want to measure the effect of an intervention on civic engagement, survey-based measures asking about recent behavior are vulnerable to subjects over-stating their engagement or mis-remembering the number of times they’ve participated in politics. For this reason, we might also want to consult administrative records whether a person voted or volunteered with community organizations. However, when we test the same hypotheses using multiple different measures, we encounter a significant statistical challenge known as multiple hypothesis testing. This issue arises because the more tests we perform, the higher the likelihood of encountering a false positive. Essentially, if we conduct, say, 20 tests, each at a significance level of 5%, we might expect one of those tests to show significant results purely by chance, even if all our null hypotheses are true. Traditionally, statisticians have used methods such as the Bonferroni correction to adjust the significance levels when multiple comparisons are made. Essentially, this increases the level of statistical significance required to conclude that an effect exists. However, these methods reduce the power of statistical tests, increasing the risk of falsely concluding that a treatment was not effective. Especially in the context of expensive IEs where sample sizes are often small, such corrections should be avoided when possible. This is where index measures come into play. By combining several indicators into a single index, we reduce the total number of hypotheses being tested. This consolidation not only simplifies our analysis but also inherently controls for the risk of multiple hypothesis testing errors. Consequently, our statistical analysis becomes not just simpler, but more accurate and meaningful, focusing on robust, interpretable results rather than being clouded by potential statistical anomalies.</p>
</div>
</section>
<section id="creating-index-measures" class="level2">
<h2 class="anchored" data-anchor-id="creating-index-measures">Creating Index Measures</h2>
<p><strong>When to create an index measure</strong></p>
<ul>
<li>When you have many ways of measuring a single concept
<ul>
<li>This is true for outcome measures, treatment measures, and covariates</li>
</ul></li>
</ul>
<p><strong>Benefits of index measures</strong></p>
<ul>
<li>Simplifies analysis (fewer graphs, tables, etc.)</li>
<li>Reduces number of hypotheses being tested</li>
</ul>
<div class="notes">
<p>This is a crucial technique, especially when you have numerous ways to measure a single concept. This applies to various types of measures including outcome measures, treatment measures, and covariates. Now, why do we create index measures? There are two main benefits: First, it simplifies our analysis. By combining multiple indicators into a single index, we reduce the complexity of our data. This means fewer graphs and tables, and a more streamlined presentation of our results. Second, creating an index measure helps in reducing the number of hypotheses being tested. This is important because it minimizes the risk of statistical errors that can occur from multiple testing.</p>
</div>
</section>
<section id="additive-scale" class="level2">
<h2 class="anchored" data-anchor-id="additive-scale">Additive Scale</h2>
<p><strong>What is an additive scale?</strong></p>
<ul>
<li>Simple sum across columns (index = column_1 + column_2)</li>
</ul>
<p><strong>When to use an additive scale</strong></p>
<ul>
<li>When variables are measured on a common scale</li>
<li>When you are interested in a cumulative amount of something
<ul>
<li>Number of times someone engaged in a specific behavior</li>
<li>Amount of money from several different sources</li>
</ul></li>
</ul>
<div class="notes">
<p>An additive scale is a straightforward yet powerful statistical tool used to combine multiple variables into a single index. This is achieved by simply summing up the values across columns. For instance, if you have two variables, the index would be calculated as the sum of column_1 and column_2. Now, let’s talk about when it’s appropriate to use an additive scale. This method is particularly useful when the variables you’re combining are measured on a common scale. This ensures that each variable contributes equally to the final index score. An additive scale is also beneficial when you’re interested in a cumulative quantity of something. For example, if you want to measure the total number of times an individual has engaged in a specific behavior, or if you’re looking to calculate the total amount of money received from several different sources. By using an additive scale, you can create a single measure that represents a comprehensive view of these cumulative or combined behaviors or contributions, making your data analysis both simpler and more meaningful.</p>
</div>
</section>
<section id="additive-scale-1" class="level2">
<h2 class="anchored" data-anchor-id="additive-scale-1">Additive Scale</h2>
<p><strong>Benefits of additive scales</strong></p>
<ul>
<li>Interpretability: number on the original scale</li>
<li>Simplicity: Just plain addition</li>
</ul>
<div class="notes">
<p>Let’s dive into some of the key benefits of using additive scales in our data analysis. First, we have interpretability. One of the major advantages of an additive scale is that the resultant index remains on the original scale of the variables. This means that the numbers produced are easy to understand and interpret because they directly relate to the familiar measures of the variables involved. Second is simplicity. The process involves plain addition, which makes it not only easy to calculate but also straightforward to explain to stakeholders or audiences who may not be familiar with complex statistical techniques. This simplicity also reduces errors in computation and data handling, making additive scales a reliable choice for many research scenarios.</p>
</div>
</section>
<section id="additive-scale-2" class="level2">
<h2 class="anchored" data-anchor-id="additive-scale-2">Additive Scale</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame with 200 observations</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable1 =</span> <span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>),  <span class="co"># Generate 200 random numbers for the first variable</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable2 =</span> <span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="at">mean =</span> <span class="dv">30</span>, <span class="at">sd =</span> <span class="dv">5</span>)   <span class="co"># Generate 200 random numbers for the second variable</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an additive index variable</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="co"># This index is simply the sum of variable1 and variable2</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">additive_index =</span> variable1 <span class="sc">+</span> variable2)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the first few rows of the generated data</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="co"># head() function shows the first six rows of the data frame by default</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="co"># The sum of variable1 and variable2 is equivalent to the additive_index value</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  variable1 variable2 additive_index
1  44.39524  40.99405       85.38930
2  47.69823  36.56206       84.26029
3  65.58708  28.67427       94.26136
4  50.70508  32.71597       83.42105
5  51.29288  27.92830       79.22118
6  67.15065  27.61877       94.76942</code></pre>
</div>
</div>
</section>
<section id="averaged-z-scores" class="level2">
<h2 class="anchored" data-anchor-id="averaged-z-scores">Averaged Z-Scores</h2>
<p><strong>What is a z-score?</strong></p>
<ul>
<li><code>Z = (X - \mu) / \sigma</code></li>
<li>Standardized: Mean of 0 and standard deviation of 1</li>
</ul>
<p><strong>When to use averaged z-scores</strong></p>
<ul>
<li>When variables are measured on different scales</li>
<li>When variables cannot be summed</li>
</ul>
<div class="notes">
<p>Another useful method is the ‘Averaged Z-Scores.’ Let’s start by understanding what a z-score is. A z-score, or standard score, is a way to describe a value’s relationship to the mean of a group of values, measured in terms of standard deviations from the mean. Mathematically, it’s expressed as Z=(X−μ)/σZ=(X−μ)/σ, where X is the variable, μ is the mean of that variable, and σ is the variable’s standard deviation. This standardization process transforms the data to have a mean of 0 and a standard deviation of 1. Now, when should we use averaged z-scores? This approach is particularly useful in two scenarios: - When variables are measured on different scales: If you’re working with variables that have different units or scales, converting them into z-scores allows them to be compared and combined meaningfully. This is because z-scores normalize the data, removing the units and putting everything on a common scale. - When variables cannot be summed directly: There are cases where it’s not appropriate or possible to sum variables directly, perhaps due to their differing natures or units. Averaged z-scores provide a way to aggregate these variables into a single index while retaining the statistical integrity of the data. By averaging these standardized scores, we can create composite indices that allow us to conduct a single hypotheses that combines multiple measures of the same outcome.</p>
</div>
</section>
<section id="averaged-z-scores-1" class="level2">
<h2 class="anchored" data-anchor-id="averaged-z-scores-1">Averaged Z-Scores</h2>
<p><br>
</p>
<p><strong>Benefits of averaged z-scores</strong></p>
<ul>
<li>Interpretability: Standard deviations from the mean</li>
<li>Outlier detection: abs(3)</li>
</ul>
<div class="notes">
<p>Continuing our discussion on averaged z-scores, let’s focus on the key benefits this statistical method brings to our data analysis. Firstly, interpretability is a major advantage. By transforming our data into z-scores, we represent each value as its distance from the mean in terms of standard deviations. This means that the transformed data points tell us how many standard deviations they lie from the average. A z-score of +1.0 indicates a value one standard deviation above the mean, while -1.0 indicates one standard deviation below. This standardization makes it easier to understand where each data point stands in relation to the group average, enhancing our ability to interpret complex data sets. For this reason, z-scores are often used to report the results of IEs. A general rule of thumb is that effects of less than 0.2 standard deviations is a small effect, between .2 and .4 is a medium effect, and anything above .4 is a very large effect. Another significant benefit is in outlier detection. By using the criterion of z-scores exceeding an absolute value of 3, we can easily identify outliers. Values that fall beyond three standard deviations from the mean are typically considered extreme. It is often important to drop extreme values from analyses to ensure that these outliers are not driving your findings.</p>
</div>
</section>
<section id="averaged-z-scores-2" class="level2">
<h2 class="anchored" data-anchor-id="averaged-z-scores-2">Averaged Z-Scores</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame with 200 observations</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable1 =</span> <span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>),  <span class="co"># Generate 200 random numbers for the first variable</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable2 =</span> <span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="at">mean =</span> <span class="dv">30</span>, <span class="at">sd =</span> <span class="dv">5</span>),   <span class="co"># Generate 200 random numbers for the second variable</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable3 =</span> <span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">3</span>)    <span class="co"># Generate 200 random numbers for the third variable</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize each variable to have a mean of 0 and a standard deviation of 1</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Here, we create three new variables (z_variable1, z_variable2, z_variable3)</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="co"># which are the standardized (z-score) versions of variable1, variable2, and variable3.</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">z_variable1 =</span> (variable1 <span class="sc">-</span> <span class="fu">mean</span>(variable1)) <span class="sc">/</span> <span class="fu">sd</span>(variable1),  <span class="co"># Z-score for variable1</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">z_variable2 =</span> (variable2 <span class="sc">-</span> <span class="fu">mean</span>(variable2)) <span class="sc">/</span> <span class="fu">sd</span>(variable2),  <span class="co"># Z-score for variable2</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">z_variable3 =</span> (variable3 <span class="sc">-</span> <span class="fu">mean</span>(variable3)) <span class="sc">/</span> <span class="fu">sd</span>(variable3)   <span class="co"># Z-score for variable3</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="averaged-z-scores-3" class="level2">
<h2 class="anchored" data-anchor-id="averaged-z-scores-3">Averaged Z-Scores</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an index by averaging the z-scores of the variables</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co"># In this case, select(., starts_with("z_variable")) selects all columns whose names start with "z_variable"</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="co"># rowMeans(select(., starts_with("z_variable"))) calculates the average of these selected columns for each row</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">average_z_score =</span> <span class="fu">rowMeans</span>(<span class="fu">select</span>(., <span class="fu">starts_with</span>(<span class="st">"z_variable"</span>))))</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the first few rows of the generated data</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  variable1 variable2 variable3 z_variable1 z_variable2 z_variable3
1  44.39524  40.99405  19.77933 -0.58516612   2.1655224 -0.10917385
2  47.69823  36.56206  16.49405 -0.23496233   1.2754946 -1.24421681
3  65.58708  28.67427  18.09576  1.66173180  -0.3085246 -0.69083761
4  50.70508  32.71597  19.91348  0.08384457   0.5031252 -0.06282826
5  51.29288  27.92830  22.01209  0.14616629  -0.4583306  0.66222741
6  67.15065  27.61877  15.04836  1.82751140  -0.5204911 -1.74369079
  average_z_score
1      0.49039415
2     -0.06789484
3      0.22078985
4      0.17471384
5      0.11668771
6     -0.14555682</code></pre>
</div>
</div>
</section>
<section id="fancier-index-techniques" class="level2">
<h2 class="anchored" data-anchor-id="fancier-index-techniques">Fancier index techniques</h2>
<p><br>
</p>
<ul>
<li>Principal Component Analysis</li>
<li>Factor Analysis</li>
<li>Inverse Covariance Weighting</li>
</ul>
<div class="notes">
<p>There are also more sophisticated techniques available to create index variables. These methods not only help us create robust indices but also enrich our analytical capabilities. First, we have Principal Component Analysis (PCA). PCA is a statistical procedure that uses an orthogonal transformation to convert a set of observations of possibly correlated variables into a set of values of linearly uncorrelated variables called principal components. This technique is especially useful when you want to reduce the dimensionality of your dataset while retaining as much variance as possible. It helps in creating a new underlying variable that explains most of the variability in your data. Next, Factor Analysis is another technique that is similar to PCA but focuses more on latent variables that cannot be measured directly. This method examines the interrelationships among a large number of variables and condenses them into a few factors for easier interpretation and analysis. Factor analysis is particularly useful when your variables are related and you suspect that they are measuring underlying factors. Lastly, Inverse Covariance Weighting. This method weights variables inversely to their covariance with other variables, aiming to minimize the impact of highly correlated variables in the analysis. It’s a way to adjust the contribution of each variable to the index based on how much unique information it provides.</p>
</div>
</section>
</section>
<section id="testing-heterogeneous-effects" class="level1">
<h1>Testing Heterogeneous Effects</h1>
<section id="interaction-terms" class="level2">
<h2 class="anchored" data-anchor-id="interaction-terms">Interaction Terms</h2>
<p><strong>What is an interaction term?</strong></p>
<ul>
<li>Simple linear models assume that the effect of predictors is independent of other factors</li>
<li>Interaction terms allow us to estimate the difference in the slope of a predictor across unit characteristics</li>
</ul>
<p><strong>What are interaction terms used for?</strong></p>
<ul>
<li>Heterogeneous effects</li>
<li>Difference-in-differences</li>
</ul>
<div class="notes">
<p>Interaction terms are crucial role in understanding heterogeneous effects in regression models. Let’s start by understanding what an interaction term is. In simple linear regression models, we typically assume that the effect of one predictor on the outcome variable is independent of other factors. However, this assumption often oversimplifies reality, as the impact of a predictor can vary depending on the levels or presence of another predictor. This is crucial in fields such as medicine, where the effectiveness of a treatment might depend on patients’ age or genetic background, and in economics, where the impact of a policy might differ across regions or demographic groups. For example, we might want to test the impact of a new teaching method on students test scores. However, we might expect that the effectiveness of this new teaching method in improving students’ test scores differs between students from low and high socioeconomic backgrounds. You might also recognize interaction terms from our difference-in-differences tutorial. In policy evaluation, interaction terms are used to implement the difference-in-differences estimation. This technique compares the before-and-after differences in outcomes between a treatment group and a control group, thus controlling for common trends that might affect both groups. Interaction terms are incorporated into regression models to allow us to estimate how the effect of one variable changes as another variable changes. Essentially, these terms help us identify and quantify synergies or interdependencies between variables.</p>
</div>
</section>
<section id="interaction-terms-1" class="level2">
<h2 class="anchored" data-anchor-id="interaction-terms-1">Interaction Terms</h2>
<div class="sourceCode" id="cb57"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>Y_i = \alpha + \beta_1 X_{i1} + \beta_2 X_{i2} + \beta_3 X_{i1}*X_{i2} + \epsilon_i</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Example:</strong> Continuous outcome with two binary predictors</p>
<ul>
<li><code>\alpha</code>: Intercept when <code>X_{i1}</code> and <code>X_{i2}</code> are 0</li>
<li><code>\beta_1</code> Slope when <code>X_{i2} = 0</code></li>
<li><code>\beta_2</code> Difference in <code>\alpha</code> between <code>X_{i2}=0</code> and <code>X_{i2}=1</code></li>
<li><code>\beta_3</code> Difference in <code>\beta_1</code> between <code>X_{i2}=0</code> and <code>X_{i2}=1</code></li>
</ul>
<div class="notes">
<p>The formula on the slide illustrates how to include an interaction term in a regression model: Yi=α+β1Xi1+β2Xi2+β3Xi1Xi2+ϵiYi=α+β1Xi1+β2Xi2+β3Xi1Xi2+ϵi In this equation: α represents the intercept, the expected value of Y when both Xi1 and Xi2 are 0. β1 shows the change in Y when Xi1 changes from 0 to 1, assuming Xi2 is 0. It reflects the isolated effect of Xi1. β2 indicates the difference in intercept (α) when Xi2 changes from 0 to 1, assuming Xi1 remains 0 β3 measures the difference in the slope of Xi1 between the scenarios when Xi2 is 0 and when Xi2 is 1. This coefficient is crucial for understanding how the relationship between Y and Xi1 changes in the presence of Xi2. By adding β3 to β1, we are able to observe how the slope of the predictor Xi1Xi1 varies across different levels of Xi2, providing a richer understanding of the data dynamics. This is particularly useful in policy analysis, medical research, and economic studies, where the effect of an intervention may depend on individual or contextual characteristics. Imagine Xi1 captures whether or not at student was exposed to the new teaching method and Xi2 captures whether or not the student is high-socioeconomic status. If the interaction term β3 is significantly positive, it suggests that high SES students benefit more from the new method compared to low SES students. This could lead to insights that help tailor educational strategies to maximize their effectiveness across different demographic groups.</p>
</div>
</section>
<section id="interaction-terms-2" class="level2">
<h2 class="anchored" data-anchor-id="interaction-terms-2">Interaction Terms</h2>
<div class="cell">
<details class="code-fold">
<summary>Interactions</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame with 200 observations</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="at">each =</span> <span class="dv">100</span>),      <span class="co"># Create a binary treatment variable: 1 for treatment, 0 for control</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="at">each =</span> <span class="dv">50</span>, <span class="at">times =</span> <span class="dv">2</span>), <span class="co"># Create a binary group variable: 1 for Group 1, 0 for Group 2</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">2</span>),  <span class="co"># Group 1: treatment</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">2</span>),  <span class="co"># Group 2: treatment</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">2</span>),  <span class="co"># Group 1: control</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">2</span>))  <span class="co"># Group 2: control</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Run linear regression model with interaction term (outcome ~ treatment * group)</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>interaction_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(outcome <span class="sc">~</span> treatment <span class="sc">*</span> group, <span class="at">data =</span> data)</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a><span class="co"># modelsummary() function provides a summary of the regression models</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lm</span>(outcome <span class="sc">~</span> treatment <span class="sc">+</span> group, <span class="at">data =</span> data),    <span class="co"># Model without interaction term</span></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lm</span>(outcome <span class="sc">~</span> treatment <span class="sc">*</span> group, <span class="at">data =</span> data)     <span class="co"># Model with interaction term</span></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate =</span> <span class="st">"{estimate}{stars} ({std.error})"</span>,</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">statistic =</span> <span class="cn">NULL</span>,</span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">gof_omit =</span> <span class="st">'IC|RMSE|Log|F|R2$|Std.'</span>,</span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">output =</span> <span class="st">"dataframe"</span></span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       part              term         statistic           Model 1
1 estimates       (Intercept) modelsummary_tmp1 13.737*** (0.283)
2 estimates         treatment modelsummary_tmp1 -2.104*** (0.326)
3 estimates             group modelsummary_tmp1 -2.905*** (0.326)
4 estimates treatment × group modelsummary_tmp1                  
5       gof          Num.Obs.                                 200
6       gof           R2 Adj.                               0.374
            Model 2
1 15.078*** (0.265)
2 -4.785*** (0.375)
3 -5.585*** (0.375)
4  5.361*** (0.531)
5               200
6             0.586</code></pre>
</div>
</div>
</section>
<section id="survey-experiments" class="level2">
<h2 class="anchored" data-anchor-id="survey-experiments">Survey Experiments</h2>
<ul>
<li><a href="https://egap.org/resource/10-things-to-know-about-survey-experiments/">10 Things to Know About Survey Experiments</a> by Christopher Grady</li>
<li><a href="https://www.pewresearch.org/short-reads/2019/01/29/good-jobs-vs-jobs-survey-experiments-can-measure-the-effects-of-question-wording-and-more/">Pew’s Question Wording Experiments</a></li>
<li><a href="https://www.annualreviews.org/doi/10.1146/annurev-polisci-042716-115726">Sniderman (2018)</a>: Review of advances in survey experiment design</li>
<li>Leeper’s <a href="https://thomasleeper.com/surveyexpcourse/">survey experiments mini-course</a>: Leeper was an academic political scientists and is now a Research Scientist at Meta</li>
</ul>
<!-- https://jrspringman.github.io/psci3200-globaldev/materials/05_autocracy1.html -->
<!-- https://github.com/jrspringman/psci3200-globaldev/blob/main/workshops/w1_quarto.qmd -->


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Content <i class="fa-brands fa-creative-commons" aria-label="creative-commons"></i> 2025 by <a href="https://jrspringman.github.io/">Jeremy Springman</a> <br> All content licensed under a <i class="fa-brands fa-creative-commons" aria-label="creative-commons"></i> <i class="fa-brands fa-creative-commons-by" aria-label="creative-commons-by"></i> <i class="fa-brands fa-creative-commons-nc" aria-label="creative-commons-nc"></i> <a href="https://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International license (CC BY-NC 4.0)</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Made with <i class="fa-brands fa-r-project" aria-label="r-project"></i> and <a href="https://quarto.org/">Quarto</a><br> <a href="https://github.com/jrspringman/psci3200-globaldev">View the source at <i class="fa-brands fa-github" aria-label="github"></i> GitHub</a></p>
</div>
  </div>
</footer>




</body></html>